<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AirFoxer Innovation Hack 2026</title>
    <meta name="description" content="AirFoxer Innovation Hackathon 2026 - Empowering Future Technologies through Open Innovation">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- QR Code Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>

    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Leaflet.js for Interactive Maps -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>

    <style>
        /* ============================================
           CSS VARIABLES - DARK THEME (DEFAULT)
           ============================================ */
        :root {
            --bg-body: #0a0a0a;
            --bg-surface: #111111;
            --bg-card: #161616;
            --bg-input: #1a1a1a;
            --primary: #f97316;
            --primary-hover: #fb923c;
            --primary-glow: rgba(249, 115, 22, 0.15);
            --secondary: #3b82f6;
            --accent: #f59e0b;
            --text-main: #f0f0f0;
            --text-muted: #888888;
            --text-light: #555555;
            --border: rgba(255, 255, 255, 0.08);
            --border-hover: rgba(249, 115, 22, 0.3);
            --shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
            --shadow-glow: 0 0 40px rgba(249, 115, 22, 0.08);
            --nav-bg: rgba(10, 10, 10, 0.8);
            --success: #22c55e;
            --error: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --radius: 16px;
            --radius-sm: 10px;
            --radius-full: 999px;
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ============================================
           LIGHT MODE
           ============================================ */
        body.light-mode {
            --bg-body: #fafafa;
            --bg-surface: #ffffff;
            --bg-card: #ffffff;
            --bg-input: #f5f5f5;
            --text-main: #111111;
            --text-muted: #666666;
            --text-light: #999999;
            --border: rgba(0, 0, 0, 0.08);
            --border-hover: rgba(249, 115, 22, 0.4);
            --shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
            --shadow-glow: 0 0 40px rgba(249, 115, 22, 0.05);
            --nav-bg: rgba(255, 255, 255, 0.85);
            --primary-glow: rgba(249, 115, 22, 0.08);
        }

        /* ============================================
           GLOBAL RESETS
           ============================================ */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            overflow-x: hidden;
            line-height: 1.6;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        img { max-width: 100%; height: auto; }
        a { text-decoration: none; color: inherit; }
        button { cursor: pointer; font-family: inherit; }
        input, select, textarea { font-family: inherit; }

        .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }
        .gap-8 { gap: 2rem; }

        /* ========== PARTNERS & SPONSORS RECTANGLE CARDS ========== */
        #hosting-partners-container,
        #sponsors-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .partner-card, .sponsor-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 2rem 1.5rem;
            min-width: 200px;
            flex: 0 1 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: transform var(--transition), border-color var(--transition);
        }

        .partner-card:hover, .sponsor-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: var(--shadow-glow);
        }

        .partner-logo, .sponsor-logo {
            width: 120px;
            height: 80px;
            border-radius: 12px;
            background: var(--bg-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.25rem;
            border: 1px solid var(--border);
            padding: 0.75rem;
            transition: border-color var(--transition);
        }

        .partner-logo img, .sponsor-logo img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 6px;
        }

        .partner-logo i, .sponsor-logo i {
            font-size: 2.5rem;
            color: var(--primary);
            opacity: 0.7;
        }

        .partner-card h3, .sponsor-card h3 {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 0.25rem;
        }

        .partner-card p, .sponsor-card p {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            line-height: 1.5;
        }

        .sponsor-tier {
            background: rgba(249,115,22,0.12);
            padding: 4px 12px;
            border-radius: 30px;
            font-size: 0.65rem;
            font-weight: 700;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid rgba(249,115,22,0.2);
            margin-top: 0.5rem;
        }

        .sponsors-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            width: 100%;
        }

        /* ============================================
           NAVIGATION
           ============================================ */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 1.25rem 0;
            background: transparent;
            transition: all var(--transition);
        }

        nav.scrolled {
            background: var(--nav-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            font-size: 1.4rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            color: var(--text-main);
            letter-spacing: -0.02em;
        }

        .logo img {
            width: 36px;
            height: 36px;
            object-fit: contain;
            border-radius: 8px;
        }

        .logo-accent { color: var(--primary); }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            font-weight: 500;
            cursor: pointer;
            font-size: 0.875rem;
            padding: 8px 14px;
            border-radius: var(--radius-sm);
            transition: all var(--transition);
            white-space: nowrap;
        }

        .nav-btn:hover {
            color: var(--primary);
            background: var(--primary-glow);
        }

        .btn-primary {
            background: var(--primary);
            color: #fff;
            padding: 12px 28px;
            border-radius: var(--radius-full);
            border: none;
            font-weight: 700;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all var(--transition);
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.15), transparent);
            opacity: 0;
            transition: opacity var(--transition);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(249, 115, 22, 0.35);
        }

        .btn-primary:hover::before { opacity: 1; }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }

        .btn-secondary {
            background: transparent;
            color: var(--text-main);
            padding: 12px 28px;
            border-radius: var(--radius-full);
            border: 1px solid var(--border);
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all var(--transition);
        }

        .btn-secondary:hover:not(:disabled) {
            border-color: var(--primary);
            color: var(--primary);
            background: var(--primary-glow);
        }

        .btn-success {
            background: var(--success);
            color: #fff;
            padding: 12px 28px;
            border-radius: var(--radius-full);
            border: none;
            font-weight: 700;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all var(--transition);
        }

        .btn-success:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(34, 197, 94, 0.3);
        }

        /* ============================================
           PROBLEM STATEMENT MODAL (UPDATED FOR MULTI-SELECT)
           ============================================ */
        .problem-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(12px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .problem-modal-content {
            background: var(--bg-card);
            border-radius: 32px;
            border: 1px solid var(--border);
            max-width: 700px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            padding: 2.5rem;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .problem-modal-header {
            margin-bottom: 2rem;
            padding-right: 40px;
        }

        .problem-modal-header h2 {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .problem-modal-header p {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .selection-counter {
            margin-top: 0.5rem;
            color: var(--primary);
            font-weight: 600;
            font-size: 1rem;
            padding: 8px 16px;
            background: rgba(249, 115, 22, 0.1);
            border-radius: 40px;
            display: inline-block;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            color: var(--text-muted);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition);
        }

        .close-modal:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: rotate(90deg);
        }

        .problem-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .problem-item {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all var(--transition);
            position: relative;
            overflow: hidden;
        }

        .problem-item:hover {
            border-color: var(--primary);
            transform: translateX(8px);
            box-shadow: 0 8px 20px rgba(249, 115, 22, 0.15);
        }

        .problem-item.selected {
            border-color: var(--primary);
            background: linear-gradient(145deg, var(--bg-surface), rgba(249, 115, 22, 0.1));
            box-shadow: 0 0 30px rgba(249, 115, 22, 0.2);
        }

        .problem-item.selected::after {
            content: 'âœ“';
            position: absolute;
            top: 10px;
            right: 15px;
            color: var(--primary);
            font-size: 1.5rem;
            font-weight: 900;
        }

        .problem-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
            padding-right: 30px;
        }

        .problem-description {
            color: var(--text-muted);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .problem-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .problem-meta i {
            color: var(--secondary);
            margin-right: 4px;
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
        }

        .selected-theme-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(249, 115, 22, 0.1);
            border: 1px solid rgba(249, 115, 22, 0.2);
            border-radius: 40px;
            padding: 8px 20px;
            margin: 1rem 0;
            color: var(--primary);
            font-weight: 600;
        }

        .selected-theme-badge i {
            color: var(--primary);
        }

        .selected-problems-container {
            background: var(--bg-surface);
            border-radius: 20px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid var(--border);
        }

        .selected-problems-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .selected-problems-header h4 {
            color: var(--text-main);
            font-size: 1rem;
        }

        .selected-problems-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .selected-problem-item {
            background: linear-gradient(145deg, var(--bg-card), var(--bg-surface));
            border: 1px solid rgba(249, 115, 22, 0.2);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .selected-problem-number {
            background: var(--primary);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .selected-problem-content {
            flex: 1;
        }

        .selected-problem-content h5 {
            color: var(--primary);
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }

        .selected-problem-content p {
            color: var(--text-muted);
            font-size: 0.8rem;
            line-height: 1.5;
        }

        .change-problem-btn {
            background: transparent;
            border: 1px solid var(--secondary);
            color: var(--secondary);
            padding: 8px 16px;
            border-radius: 40px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition);
        }

        .change-problem-btn:hover {
            background: var(--secondary);
            color: #fff;
        }

        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 120px 24px 60px;
            position: relative;
            overflow: hidden;
            background: radial-gradient(ellipse at 50% 0%, rgba(249, 115, 22, 0.08) 0%, transparent 60%),
                        radial-gradient(ellipse at 80% 80%, rgba(59, 130, 246, 0.04) 0%, transparent 50%),
                        var(--bg-body);
        }

        .hero-canvas {
            position: absolute;
            inset: 0;
            z-index: 0;
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            max-width: 800px;
        }

        .status-pill {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: var(--bg-card);
            padding: 10px 24px;
            border-radius: var(--radius-full);
            border: 1px solid var(--border);
            margin-bottom: 2.5rem;
            font-size: 0.85rem;
            color: var(--primary);
            font-weight: 600;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(249, 115, 22, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(249, 115, 22, 0); }
            100% { box-shadow: 0 0 0 0 rgba(249, 115, 22, 0); }
        }

        h1 {
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            font-weight: 900;
            line-height: 1.05;
            margin-bottom: 1.5rem;
            letter-spacing: -0.03em;
            color: var(--text-main);
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--primary), #fbbf24, var(--primary));
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 3s linear infinite;
        }

        @keyframes shimmer {
            to { background-position: 200% center; }
        }

        .subtitle {
            font-size: 1.15rem;
            color: var(--text-muted);
            max-width: 550px;
            margin: 0 auto 3rem;
            line-height: 1.7;
        }

        .countdown-container {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .countdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: var(--bg-card);
            padding: 1.25rem 1.75rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            min-width: 100px;
            transition: all var(--transition);
        }

        .countdown-item:hover {
            border-color: var(--border-hover);
            box-shadow: var(--shadow-glow);
        }

        .countdown-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--primary);
            line-height: 1;
            font-variant-numeric: tabular-nums;
            letter-spacing: -0.02em;
        }

        .countdown-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-top: 0.5rem;
            font-weight: 600;
        }

        .hero-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 4rem;
        }

        .stats {
            display: flex;
            gap: 4rem;
            justify-content: center;
            margin-top: 4rem;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            animation: float 4s ease-in-out infinite;
            transition: transform 0.3s ease;
            position: relative;
        }

        .stat-item:nth-child(1) { animation-delay: 0s; }
        .stat-item:nth-child(2) { animation-delay: 0.6s; }
        .stat-item:nth-child(3) { animation-delay: 1.2s; }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0px); }
        }

        .stat-number {
            display: block;
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--text-main);
            line-height: 1;
            margin-bottom: 0.4rem;
            background: linear-gradient(135deg, var(--primary), #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 15px rgba(249,115,22,0.3);
            transition: all 0.3s ease;
        }

        .stat-item:hover .stat-number {
            transform: scale(1.1);
            text-shadow: 0 0 30px rgba(249,115,22,0.8);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .notification-bar {
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border);
            padding: 14px 0;
        }

        .notif-container {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            max-width: 900px;
            margin: 0 auto;
        }

        .badge {
            background: var(--primary);
            color: #fff;
            font-size: 0.65rem;
            font-weight: 800;
            padding: 4px 12px;
            border-radius: var(--radius-full);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            white-space: nowrap;
        }

        .ticker-wrap {
            flex: 1;
            overflow: hidden;
            white-space: nowrap;
        }

        .ticker-text {
            display: inline-block;
            animation: ticker 25s linear infinite;
            padding-left: 100%;
            color: var(--text-muted);
            font-weight: 500;
            font-size: 0.9rem;
        }

        @keyframes ticker {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-100%, 0, 0); }
        }

        .section {
            padding: 6rem 0;
            position: relative;
        }

        .section-surface {
            background: var(--bg-surface);
        }

        .section-title {
            font-size: clamp(2rem, 4vw, 2.75rem);
            font-weight: 800;
            color: var(--text-main);
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
        }

        .section-title .accent { color: var(--primary); }
        .section-title .accent-blue { color: var(--secondary); }

        .section-subtitle {
            color: var(--text-muted);
            font-size: 1.05rem;
            margin-bottom: 3rem;
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 2rem;
            border-radius: var(--radius);
            transition: all var(--transition);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
            opacity: 0;
            transition: opacity var(--transition);
        }

        .card:hover {
            border-color: var(--border-hover);
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
        }

        .card:hover::before { opacity: 1; }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            margin-bottom: 1.25rem;
        }

        .card-icon.orange { background: rgba(249, 115, 22, 0.12); color: var(--primary); }
        .card-icon.blue { background: rgba(59, 130, 246, 0.12); color: var(--secondary); }
        .card-icon.green { background: rgba(34, 197, 94, 0.12); color: var(--success); }
        .card-icon.purple { background: rgba(168, 85, 247, 0.12); color: #a855f7; }
        .card-icon.pink { background: rgba(236, 72, 153, 0.12); color: #ec4899; }

        .card h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text-main);
        }

        .card p {
            font-size: 0.9rem;
            color: var(--text-muted);
            line-height: 1.6;
            margin-bottom: 1.25rem;
            flex: 1;
        }

        .card .btn-small {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 8px 16px;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-main);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all var(--transition);
            align-self: flex-start;
            margin-top: auto;
        }

        .card .btn-small:hover {
            background: var(--primary-glow);
            border-color: var(--primary);
            color: var(--primary);
        }

        .card .btn-small i { font-size: 0.8rem; }

        .grid { display: grid; gap: 1.5rem; }
        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
        .span-2 { grid-column: span 2; }

        .objectives-list {
            list-style: none;
            padding: 0;
            margin: 0 0 2rem;
        }

        .objectives-list li {
            padding: 12px 0;
            color: var(--text-muted);
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid var(--border);
        }

        .objectives-list li:last-child { border-bottom: none; }

        .objectives-list .check-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(34, 197, 94, 0.12);
            color: var(--success);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            flex-shrink: 0;
        }

        .info-box {
            padding: 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
        }

        .info-box h3 {
            color: var(--secondary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }

        .info-box p {
            font-size: 0.9rem;
            color: var(--text-muted);
            line-height: 1.7;
        }

        .flow-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            position: relative;
        }

        .flow-step { text-align: center; }

        .icon-circle {
            width: 80px;
            height: 80px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.25rem;
            font-size: 1.75rem;
            transition: all var(--transition);
        }

        .flow-step:hover .icon-circle {
            transform: scale(1.1);
            border-color: var(--primary);
            box-shadow: var(--shadow-glow);
        }

        .flow-step h3 {
            color: var(--text-main);
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .flow-step p {
            color: var(--text-muted);
            font-size: 0.9rem;
            max-width: 280px;
            margin: 0 auto;
        }

        .timeline { max-width: 700px; margin: 0 auto; }

        .timeline-item {
            display: flex;
            gap: 2rem;
        }

        .timeline-line {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .timeline-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--bg-card);
            border: 3px solid var(--secondary);
            z-index: 2;
            flex-shrink: 0;
        }

        .timeline-dot.green { border-color: var(--success); }
        .timeline-dot.orange { border-color: var(--primary); }

        .timeline-bar {
            width: 2px;
            flex: 1;
            background: var(--border);
            min-height: 40px;
        }

        .timeline-content {
            padding-bottom: 2.5rem;
        }

        .timeline-time {
            display: inline-block;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            font-size: 0.8rem;
            padding: 4px 12px;
            border-radius: 6px;
            margin-bottom: 8px;
        }

        .timeline-time.green { background: rgba(34, 197, 94, 0.12); color: var(--success); }
        .timeline-time.blue { background: rgba(59, 130, 246, 0.12); color: var(--secondary); }
        .timeline-time.orange { background: rgba(249, 115, 22, 0.12); color: var(--primary); }

        .timeline-content h3 {
            color: var(--text-main);
            font-size: 1.05rem;
            margin-bottom: 4px;
        }

        .timeline-content p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .empty-placeholder {
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            padding: 4rem;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .team-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 2rem;
            border-radius: var(--radius);
            text-align: center;
            transition: all var(--transition);
        }

        .team-card:hover {
            transform: translateY(-6px);
            border-color: var(--border-hover);
            box-shadow: var(--shadow-glow);
        }

        .team-avatar {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.25rem;
            border-radius: 50%;
            overflow: hidden;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 3px;
        }

        .team-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            background: var(--bg-card);
        }

        .team-avatar i {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            background: var(--bg-card);
            border-radius: 50%;
            font-size: 1.5rem;
            color: var(--text-muted);
        }

        .team-card h3 {
            color: var(--text-main);
            font-size: 1.05rem;
            margin-bottom: 0.4rem;
        }

        .team-role {
            color: var(--primary);
            font-weight: 600;
            font-size: 0.85rem;
            display: block;
            margin-bottom: 0.75rem;
        }

        .team-bio {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .team-socials {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .team-socials a {
            color: var(--text-muted);
            font-size: 1.1rem;
            transition: color var(--transition);
        }

        .team-socials a:hover { color: var(--primary); }

        .contact-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
        }

        .contact-items { display: flex; flex-direction: column; gap: 1.75rem; }

        .contact-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .contact-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            flex-shrink: 0;
            border: 1px solid var(--border);
            background: var(--bg-card);
        }

        .contact-icon.orange { color: var(--primary); border-color: rgba(249, 115, 22, 0.2); }
        .contact-icon.blue { color: var(--secondary); border-color: rgba(59, 130, 246, 0.2); }
        .contact-icon.green { color: var(--success); border-color: rgba(34, 197, 94, 0.2); }

        .contact-item h4 {
            color: var(--text-main);
            font-size: 0.95rem;
            margin-bottom: 4px;
        }

        .contact-item p {
            color: var(--text-muted);
            font-size: 0.875rem;
            line-height: 1.6;
        }

        .map-placeholder {
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--border);
            height: 450px;
            background: var(--bg-card);
            position: relative;
        }

        #venue-map {
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        #venue-map .leaflet-popup-content {
            font-family: var(--font-family);
            margin: 0;
        }

        #venue-map .leaflet-popup-content-wrapper {
            border-radius: 8px;
        }

        footer {
            background: var(--bg-surface);
            padding: 3rem 0;
            border-top: 1px solid var(--border);
        }

        .footer-inner {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1.5rem;
        }

        .footer-copy {
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .footer-socials {
            display: flex;
            gap: 1.5rem;
        }

        .footer-socials a {
            color: var(--text-muted);
            font-size: 1.1rem;
            transition: color var(--transition);
        }

        .footer-socials a:hover { color: var(--primary); }

        .auth-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
            padding: 2rem;
        }

        .auth-card {
            background: var(--bg-card);
            padding: 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            width: 100%;
            max-width: 500px;
            position: relative;
            box-shadow: var(--shadow);
            max-height: 90vh;
            overflow-y: auto;
        }

        .auth-card::-webkit-scrollbar { width: 6px; }
        .auth-card::-webkit-scrollbar-track { background: transparent; }
        .auth-card::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

        .auth-card-wide { max-width: 950px; }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.25rem;
            font-size: 1.5rem;
        }

        .auth-icon.orange {
            background: rgba(249, 115, 22, 0.12);
            color: var(--primary);
        }

        .auth-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--text-main);
            line-height: 1.2;
            margin-bottom: 0.5rem;
        }

        .auth-subtitle {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            cursor: pointer;
            transition: all var(--transition);
        }

        .close-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .form-group { margin-bottom: 1.25rem; }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-main);
            font-size: 0.95rem;
            transition: all var(--transition);
            outline: none;
        }

        .form-input:focus,
        .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-glow);
        }

        .form-input:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .form-input::placeholder {
            color: var(--text-light);
        }

        textarea.form-input { resize: vertical; min-height: 80px; }

        .google-btn {
            width: 100%;
            padding: 14px;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            color: var(--text-main);
            font-size: 0.95rem;
            transition: all var(--transition);
        }

        .google-btn:hover {
            border-color: var(--border-hover);
            background: var(--primary-glow);
        }

        .google-btn img { width: 20px; height: 20px; }

        .divider {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 1.5rem 0;
            color: var(--text-light);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid var(--border);
        }

        .divider:not(:empty)::before { margin-right: 1em; }
        .divider:not(:empty)::after { margin-left: 1em; }

        .reg-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 1.5rem; 
            margin-bottom: 1rem;
        }

        .reg-section-title {
            grid-column: span 2;
            font-size: 0.9rem;
            font-weight: 800;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin: 1.5rem 0 0.8rem;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .member-card {
            padding: 1.75rem 1.5rem;
            background: linear-gradient(145deg, var(--bg-surface), var(--bg-card));
            border-radius: 24px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 20px -8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .member-card:hover {
            transform: translateY(-6px);
            border-color: var(--primary);
            box-shadow: 0 20px 30px -10px var(--primary-glow);
        }

        .member-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .member-card:hover::before {
            opacity: 1;
        }

        .member-badge {
            display: inline-block;
            background: rgba(249,115,22,0.15);
            color: var(--primary);
            font-weight: 800;
            font-size: 0.7rem;
            padding: 4px 16px;
            border-radius: 30px;
            margin-bottom: 1rem;
            border: 1px solid rgba(249,115,22,0.2);
            letter-spacing: 0.5px;
        }

        .member-badge.lead {
            background: rgba(59,130,246,0.15);
            color: var(--secondary);
            border-color: rgba(59,130,246,0.3);
        }

        .member-card label {
            font-size: 0.65rem;
            font-weight: 800;
            color: var(--text-light);
            text-transform: uppercase;
            display: block;
            margin-bottom: 0.4rem;
            letter-spacing: 0.06em;
        }

        .member-card .form-input {
            margin-bottom: 1rem;
            font-size: 0.9rem;
            padding: 10px 14px;
            border-radius: 14px;
            background: var(--bg-input);
        }

        .member-row {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .member-row .form-input {
            margin-bottom: 0;
        }

        .usn-input {
            margin-top: 0.25rem;
        }

        .confirmation-box {
            background: linear-gradient(145deg, rgba(249,115,22,0.08), rgba(59,130,246,0.05));
            padding: 1.5rem 2rem;
            border-radius: 60px;
            border: 1px solid rgba(249,115,22,0.2);
            margin: 2rem 0 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.95rem;
        }

        .confirmation-box input[type="checkbox"] {
            width: 24px;
            height: 24px;
            accent-color: var(--primary);
            transform: scale(1.1);
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            background: var(--bg-surface);
            padding: 0.75rem 1.5rem;
            border-radius: 60px;
            border: 1px solid var(--border);
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }

        .step {
            padding: 6px 20px;
            border-radius: var(--radius-full);
            font-size: 0.8rem;
            font-weight: 700;
        }

        .step-done {
            background: rgba(34, 197, 94, 0.15);
            color: var(--success);
        }

        .step-active {
            background: var(--primary);
            color: #fff;
        }

        .notification-dropdown {
            position: absolute;
            top: 50px;
            right: 0;
            width: 340px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: none;
            z-index: 1001;
            overflow: hidden;
        }

        .notification-dropdown.active { display: block; }

        .notif-header {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-surface);
        }

        .notif-header strong { color: var(--text-main); font-size: 0.9rem; }

        .notif-header button {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 0.75rem;
            cursor: pointer;
            font-weight: 700;
        }

        .notif-list { max-height: 300px; overflow-y: auto; }

        .notif-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            font-size: 0.85rem;
            color: var(--text-muted);
            transition: background var(--transition);
            cursor: pointer;
        }

        .notif-item:hover { background: var(--bg-surface); }
        .notif-item strong { color: var(--text-main); display: block; margin-bottom: 4px; }
        .notif-item p { margin: 4px 0; font-size: 0.8rem; }
        .notif-item small { color: var(--text-light); }

        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 99999;
            padding: 14px 24px;
            border-radius: var(--radius-sm);
            color: #fff;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: toastIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 400px;
        }

        .toast-success { background: var(--success); }
        .toast-error { background: var(--error); }
        .toast-info { background: var(--info); }
        .toast-warning { background: var(--warning); }

        @keyframes toastIn {
            from { transform: translateX(120%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        #landing-view { display: block; }
        #dashboard-view { display: none; min-height: 100vh; padding-top: 100px; background: var(--bg-body); }
        #dashboard-view:not(.hidden) { display: block; }

        .dashboard-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px 24px;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            background: var(--bg-card);
            padding: 1.75rem 2rem;
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .dash-info {
            display: flex;
            align-items: center;
            gap: 1.25rem;
        }

        .dash-icon {
            width: 52px;
            height: 52px;
            background: rgba(249, 115, 22, 0.12);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: var(--primary);
        }

        .dash-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-main);
            margin: 0;
        }

        .dash-track-label {
            font-size: 0.65rem;
            font-weight: 800;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .dash-track {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--primary);
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .badge-pending {
            background: rgba(245, 158, 11, 0.12);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .badge-verified {
            background: rgba(34, 197, 94, 0.12);
            color: var(--success);
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .badge-rejected {
            background: rgba(239, 68, 68, 0.12);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .dash-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .dash-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.75rem;
        }

        .dash-card-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .roster-member {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: var(--bg-surface);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            margin-bottom: 8px;
        }

        .roster-info { display: flex; flex-direction: column; }

        .roster-name {
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--text-main);
        }

        .roster-email {
            font-size: 0.7rem;
            color: var(--text-light);
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.03em;
        }

        .roster-badge {
            font-size: 0.65rem;
            font-weight: 800;
            padding: 3px 10px;
            border-radius: 4px;
            text-transform: uppercase;
            background: var(--bg-card);
            color: var(--text-muted);
        }

        .roster-badge.lead {
            background: rgba(249, 115, 22, 0.12);
            color: var(--primary);
        }

        .creds-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .cred-box {
            padding: 1rem;
            background: var(--bg-surface);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            text-align: center;
        }

        .cred-label {
            font-size: 0.6rem;
            font-weight: 800;
            color: var(--text-light);
            text-transform: uppercase;
            display: block;
            margin-bottom: 6px;
            letter-spacing: 0.08em;
        }

        .cred-value {
            font-size: 1.25rem;
            font-weight: 900;
            color: var(--text-main);
            font-family: 'JetBrains Mono', monospace;
        }

        .payment-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 2rem;
            margin-bottom: 1.5rem;
        }

        .payment-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .payment-header i {
            font-size: 2rem;
            color: var(--primary);
        }

        .payment-header h2 {
            color: var(--text-main);
            font-size: 1.25rem;
        }

        .payment-header p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .payment-info {
            background: var(--bg-surface);
            padding: 1.5rem;
            border-radius: var(--radius-sm);
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
        }

        .payment-info h4 {
            color: var(--text-main);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .payment-info ul {
            list-style: none;
            padding: 0;
        }

        .payment-info li {
            margin-bottom: 0.5rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .payment-info li i { color: var(--primary); width: 16px; text-align: center; }

        .qr-wrapper {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .qr-box {
            display: inline-block;
            padding: 1rem;
            background: #fff;
            border-radius: 12px;
            border: 2px solid var(--border);
        }

        .qr-box-label {
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .payment-note {
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            background: rgba(249, 115, 22, 0.06);
            border-radius: 8px;
            border-left: 3px solid var(--primary);
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .payment-note strong { color: var(--primary); }

        .payment-status-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .payment-status-row .status-icon { font-size: 1.25rem; }
        .payment-status-row .status-icon.pending { color: var(--warning); }
        .payment-status-row .status-icon.verified { color: var(--success); }
        .payment-status-row .status-icon.rejected { color: var(--error); }
        .payment-status-row strong { color: var(--text-main); display: block; }
        .payment-status-row p { color: var(--text-muted); font-size: 0.85rem; margin-top: 4px; }

        #payment-status-display {
            padding: 1rem;
            background: var(--bg-surface);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
        }

        .utr-input-group {
            display: flex;
            gap: 1rem;
            margin-top: 0.75rem;
        }

        .utr-input-group input { flex: 1; }

        .payment-actions {
            margin-top: 1.5rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .qr-section {
            margin-bottom: 1.5rem;
        }

        .qr-container { text-align: center; }
        .qr-code { width: 200px; height: 200px; margin: 0 auto 1rem; }
        .qr-details { margin-top: 1rem; }
        .qr-details h4 { color: var(--text-main); margin-bottom: 0.5rem; }
        .qr-details p { color: var(--text-muted); font-size: 0.9rem; }
        .qr-error { color: var(--error); padding: 20px; }

        .submission-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.25rem;
        }

        .submission-form .full-width { grid-column: span 2; }

        .cert-placeholder {
            padding: 3rem;
            background: var(--bg-surface);
            border-radius: var(--radius);
            border: 1px dashed var(--border);
            text-align: center;
        }

        .cert-placeholder i {
            font-size: 3rem;
            color: var(--primary);
            opacity: 0.3;
            margin-bottom: 1rem;
        }

        .cert-placeholder p {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .cert-placeholder p:first-of-type {
            color: var(--text-main);
            font-weight: 600;
            font-size: 1.05rem;
            margin-bottom: 0.5rem;
        }

        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .modal {
            background: var(--bg-card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border);
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: var(--bg-card);
            z-index: 10;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-surface);
            border: 1px solid var(--border);
            color: var(--text-muted);
            cursor: pointer;
            transition: all var(--transition);
        }

        .modal-close:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .modal-body { padding: 24px; }

        .spinner { animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .reserved-section {
            padding: 2rem;
            border: 1px dashed var(--border);
            border-radius: var(--radius);
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin: 2rem auto;
            max-width: 800px;
            background: var(--bg-card);
        }

        .reserved-section .highlight { color: var(--primary); font-weight: 600; }

        @media (max-width: 1024px) {
            .grid-3 { grid-template-columns: repeat(2, 1fr); }
            .contact-grid { grid-template-columns: 1fr; gap: 2rem; }
            .dash-grid { grid-template-columns: 1fr; }
            .reg-grid { grid-template-columns: 1fr; }
            .reg-section-title { grid-column: span 1; }
        }

        @media (max-width: 768px) {
            .container { padding: 0 16px; }

            .nav-links {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: var(--bg-body);
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 0.5rem;
                z-index: 999;
                padding: 2rem;
            }

            .nav-links.mobile-open {
                display: flex;
            }

            .nav-links .nav-btn {
                font-size: 1.1rem;
                padding: 14px 24px;
                width: 100%;
                text-align: center;
                border-radius: var(--radius-sm);
            }

            .nav-links .nav-btn:hover {
                background: var(--primary-glow);
            }

            .mobile-menu-btn {
                display: flex !important;
                align-items: center;
                justify-content: center;
                width: 40px;
                height: 40px;
                background: var(--bg-card);
                border: 1px solid var(--border);
                border-radius: var(--radius-sm);
                color: var(--text-main);
                font-size: 1.15rem;
                z-index: 1001;
            }

            h1 { font-size: 2.25rem; }
            .subtitle { font-size: 1rem; margin-bottom: 2rem; }
            .status-pill { padding: 8px 16px; font-size: 0.75rem; }

            .countdown-container { gap: 0.5rem; }
            .countdown-item {
                min-width: 70px;
                padding: 0.75rem 1rem;
            }
            .countdown-number { font-size: 1.75rem; }
            .countdown-label { font-size: 0.65rem; }

            .hero-actions { flex-direction: column; align-items: center; }
            .hero-actions .btn-primary,
            .hero-actions .btn-secondary { width: 100%; justify-content: center; }

            .stats { gap: 2rem; }
            .stat-number { font-size: 2rem; }

            .grid-2, .grid-3, .flow-grid { grid-template-columns: 1fr; }
            .span-2 { grid-column: span 1; }

            .submission-form { grid-template-columns: 1fr; }
            .submission-form .full-width { grid-column: span 1; }

            .auth-card { padding: 1.5rem; margin: 1rem; }

            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
                padding: 1.25rem;
            }

            .creds-grid { grid-template-columns: 1fr; }

            .utr-input-group { flex-direction: column; }

            .payment-actions { flex-direction: column; }
            .payment-actions button { width: 100%; justify-content: center; }

            .member-row { flex-direction: column; }

            .confirmation-box { flex-direction: column; text-align: center; border-radius: 30px; }

            .toast {
                left: 16px;
                right: 16px;
                bottom: 16px;
                max-width: none;
            }

            .notification-dropdown {
                position: fixed;
                top: auto;
                bottom: 0;
                left: 0;
                right: 0;
                width: 100%;
                border-radius: var(--radius) var(--radius) 0 0;
                max-height: 60vh;
            }

            .problem-modal-content {
                padding: 1.5rem;
                margin: 1rem;
            }

            .problem-modal-header h2 {
                font-size: 1.4rem;
            }
        }

        @media (max-width: 400px) {
            h1 { font-size: 1.85rem; }
            .countdown-item { min-width: 60px; padding: 0.5rem; }
            .countdown-number { font-size: 1.5rem; }
        }

        .mobile-menu-btn { display: none; }

        ::selection {
            background: rgba(249, 115, 22, 0.25);
            color: var(--text-main);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-body); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary); }
    </style>
</head>
<body>

    <!-- Toast Notification -->
    <div id="message-box"></div>

    <!-- Problem Statement Modal (UPDATED FOR MULTI-SELECT) -->
    <div id="problemModal" class="problem-modal" style="display: none;">
        <div class="problem-modal-content">
            <button class="close-modal" onclick="closeProblemModal()">
                <i class="fa-solid fa-times"></i>
            </button>
            
            <div class="problem-modal-header">
                <h2 id="modalThemeTitle">Select Problem Statements</h2>
                <p>Choose up to 5 problem statements for your team to work on. Click on multiple statements to select them.</p>
                <div class="selection-counter">
                    Selected: <span id="selectedCount">0</span>/5
                </div>
            </div>

            <div id="selectedThemeBadge" class="selected-theme-badge" style="display: none;">
                <i class="fa-solid fa-check-circle"></i>
                <span id="selectedThemeName"></span>
            </div>

            <div id="problemList" class="problem-list">
                <!-- Problem statements will be loaded here dynamically -->
            </div>

            <div class="modal-actions">
                <button class="btn-secondary" onclick="closeProblemModal()">Cancel</button>
                <button class="btn-primary" id="confirmProblemBtn" onclick="confirmProblemSelection()" disabled>
                    Confirm Selection
                </button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav id="navbar">
        <div class="container flex justify-between items-center">
            <div class="logo" onclick="switchView('landing')">
                <img src="assets/AirFoxer.jpeg" alt="AirFoxer Logo" onerror="this.src='https://via.placeholder.com/36?text=AF'">
                <span>AirFoxer <span class="logo-accent">HACK</span></span>
            </div>

            <div class="nav-links">
                <button class="nav-btn" onclick="switchView('landing')">Home</button>
                <button class="nav-btn" onclick="switchView('landing', 'objectives-section')">Objectives</button>
                <button class="nav-btn" onclick="switchView('landing', 'tracks-section')">Themes</button>
                <button class="nav-btn" onclick="switchView('landing', 'public-docs')">Resources</button>
                <button class="nav-btn" onclick="switchView('landing', 'schedule')">Schedule</button>

                <div id="dashboard-nav-item" class="hidden">
                    <button class="nav-btn" onclick="switchView('dashboard')"><i class="fa-solid fa-gauge"></i> Dashboard</button>
                </div>

                <div id="notif-parent" style="position: relative;">
                    <button class="nav-btn" onclick="toggleNotifications()"><i class="fa-regular fa-bell"></i></button>
                    <span id="notif-badge" class="hidden" style="position:absolute;top:-5px;right:-5px;width:10px;height:10px;background:#ef4444;border-radius:50%;border:2px solid var(--bg-body);"></span>
                    <div id="notification-dropdown" class="notification-dropdown">
                        <div class="notif-header">
                            <strong>Notifications</strong>
                            <button onclick="clearNotifs()">Clear All</button>
                        </div>
                        <div class="notif-list" id="notif-list">
                            <div class="notif-item">Welcome to AirFoxer 2026! Login as Lead to register.</div>
                        </div>
                    </div>
                </div>

                <button class="nav-btn" onclick="toggleTheme()"><i class="fa-solid fa-sun" id="theme-icon"></i></button>

                <div id="guest-nav" class="flex gap-2">
                    <button class="nav-btn" onclick="switchView('lead-login')">Lead Login</button>
                    <button class="nav-btn" onclick="switchView('member-hub-auth')">Member Login</button>
                </div>

                <div id="auth-nav" class="hidden items-center gap-4">
                    <button id="nav-reg-btn" class="btn-primary hidden" onclick="switchView('register')">Register Team</button>
                    <button class="btn-secondary" onclick="logout()">Logout</button>
                </div>
            </div>

            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- ==================== LANDING VIEW ==================== -->
    <div id="landing-view">
        <section class="hero">
            <canvas id="particle-canvas" class="hero-canvas"></canvas>
            <div class="container hero-content">
                <div class="status-pill">
                    <span class="dot"></span>
                    <span>Registration Deadline: <span class="deadline-date">22 Feb 2026</span></span>
                </div>

                <h1>AirFoxer INNOVATION<br><span class="gradient-text">HACKATHON 2026</span></h1>

                <p class="subtitle">Empowering Future Technologies through Open Innovation</p>

                <div id="countdown" class="countdown-container">
                    <div class="countdown-item">
                        <span id="days" class="countdown-number">00</span>
                        <span class="countdown-label">Days</span>
                    </div>
                    <div class="countdown-item">
                        <span id="hours" class="countdown-number">00</span>
                        <span class="countdown-label">Hours</span>
                    </div>
                    <div class="countdown-item">
                        <span id="minutes" class="countdown-number">00</span>
                        <span class="countdown-label">Minutes</span>
                    </div>
                    <div class="countdown-item">
                        <span id="seconds" class="countdown-number">00</span>
                        <span class="countdown-label">Seconds</span>
                    </div>
                </div>

                <div class="hero-actions">
                    <button class="btn-primary" id="hero-action-btn" onclick="switchView('lead-login')">
                        <i class="fa-solid fa-ticket"></i> Start Registration
                    </button>
                    <a href="https://chat.whatsapp.com/JNX4osphTQw7PBHPDXdqDY" target="_blank" class="btn-secondary">
                        <i class="fa-brands fa-whatsapp"></i> Join WhatsApp
                    </a>
                </div>

                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-number">â‚¹4.5 Lakhs</span>
                        <span class="stat-label">Prize Pool</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">Internships</span>
                        <span class="stat-label">& Prizes</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">1 Day</span>
                        <span class="stat-label">Challenge</span>
                    </div>
                </div>
            </div>
        </section>

        <div class="notification-bar">
            <div class="container">
                <div class="notif-container">
                    <span class="badge">LIVE</span>
                    <div class="ticker-wrap">
                        <div class="ticker-text" id="ticker-text">
                            Registration open! &nbsp;&nbsp;|&nbsp;&nbsp;
                            Pre-Hackathon workshops announced. &nbsp;&nbsp;|&nbsp;&nbsp;
                            Final deadline: 05th March 2026 &nbsp;&nbsp;|&nbsp;&nbsp;
                            2 female participants per team. &nbsp;&nbsp;|&nbsp;&nbsp;
                            Plagiarism is strictly prohibited.&nbsp;&nbsp;|&nbsp;&nbsp;
                        </div>
                    </div>
                    <i class="fa-solid fa-arrow-right" style="color: var(--primary); cursor: pointer;"></i>
                </div>
            </div>
        </div>

        <div id="public-docs" class="reserved-section">
            <p>This section is reserved for public documentation and resources.</p>
            <p>Currently under construction. GO AHEAD WITH REGISTRATION!
                <span class="highlight">Click "Start Registration" above to begin.</span></p>
        </div>

        <section class="section" id="objectives-section">
            <div class="container">
                <div class="grid-2" style="display: grid; gap: 2rem;">
                    <div>
                        <h2 class="section-title">Objectives</h2>
                        <ul class="objectives-list">
                            <li><span class="check-icon"><i class="fa-solid fa-check"></i></span> Encourage original, out-of-the-box thinking.</li>
                            <li><span class="check-icon"><i class="fa-solid fa-check"></i></span> Identify high-potential ideas for industry funding.</li>
                            <li><span class="check-icon"><i class="fa-solid fa-check"></i></span> Enable strong collaboration between academia & industry.</li>
                            <li><span class="check-icon"><i class="fa-solid fa-check"></i></span> Atleast 2 female participants per team.</li>
                            <li><span class="check-icon"><i class="fa-solid fa-check"></i></span> Plagiarism is strictly prohibited.</li>
                        </ul>
                    </div>
                    <div>
                        <!-- <div class="info-box">
                            <h3><i class="fa-solid fa-lightbulb"></i> Open Innovation</h3>
                            <p>The hackathon emphasizes experimentation, inclusivity, and long-term impact with IP collaboration opportunities.</p>
                            <a href="assets/problem_statement.pdf" target="_blank" class="btn-secondary" style="display: inline-block; margin-top: 1rem;">
                                <i class="fa-solid fa-file-pdf"></i> View PDF
                            </a>
                        </div> -->
                    </div>
                </div>
            </div>
        </section>

        <section class="section section-surface" id="tracks-section">
            <div class="container">
                <h2 class="section-title text-center" style="margin-bottom: 2rem;">Hackathon <span class="accent">Themes</span></h2>
                <div class="grid grid-2" id="tracks">
                    <div class="card"><div class="card-icon orange"><i class="fa-solid fa-bolt"></i></div><h3>Intelligent Energy</h3><p>Power Systems, Renewable Integration & Efficiency.</p><a href="assets/T1.pdf" target="_blank" class="btn-small"><i class="fa-regular fa-file-pdf"></i> Problem Statement</a></div>
                    <div class="card"><div class="card-icon blue"><i class="fa-solid fa-car-side"></i></div><h3>Sustainable Transport</h3><p>Mobility Ecosystems, Charging & Battery Intel.</p><a href="assets/T2.pdf" target="_blank" class="btn-small"><i class="fa-regular fa-file-pdf"></i> Problem Statement</a></div>
                    <div class="card"><div class="card-icon green"><i class="fa-solid fa-network-wired"></i></div><h3>Connected Infra</h3><p>Digital Networks, Edge Computing & Monitoring.</p><a href="assets/T3.pdf" target="_blank" class="btn-small"><i class="fa-regular fa-file-pdf"></i> Problem Statement</a></div>
                    <div class="card"><div class="card-icon purple"><i class="fa-solid fa-robot"></i></div><h3>Industry 5.0</h3><p>Smart Automation & AI-Assisted Systems.</p><a href="assets/T4.pdf" target="_blank" class="btn-small"><i class="fa-regular fa-file-pdf"></i> Problem Statement</a></div>
                    <div class="card span-2"><div class="card-icon pink"><i class="fa-solid fa-rocket"></i></div><h3>Open Innovation Track</h3><p>Breakthrough ideas across any domain with high impact potential.</p></div>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <div class="text-center" style="margin-bottom: 4rem;">
                    <h2 class="section-title">Pre-Hackathon <span class="accent">Workshops</span></h2>
                    <p class="section-subtitle">Jan 30 - Feb 22, 2026</p>
                </div>
                <div class="flow-grid">
                    <div class="flow-step">
                        <div class="icon-circle" style="color: var(--secondary); border-color: var(--secondary);">
                            <i class="fa-solid fa-brain"></i>
                        </div>
                        <h3>Ideation</h3>
                        <p>Problem identification & creative thinking techniques.</p>
                    </div>
                    <div class="flow-step">
                        <div class="icon-circle" style="color: var(--primary); border-color: var(--primary);">
                            <i class="fa-solid fa-tools"></i>
                        </div>
                        <h3>Prototyping</h3>
                        <p>Rapid MVP development & industry standards.</p>
                    </div>
                    <div class="flow-step">
                        <div class="icon-circle" style="color: var(--success); border-color: var(--success);">
                            <i class="fa-solid fa-microphone"></i>
                        </div>
                        <h3>Pitching</h3>
                        <p>Storytelling & presentation skills for funding.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="section section-surface" id="schedule">
            <div class="container">
                <div class="text-center" style="margin-bottom: 4rem;">
                    <h2 class="section-title">Hackathon Day <span class="accent">Schedule</span></h2>
                    <p class="section-subtitle">March 12, 2026</p>
                </div>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-line">
                            <div class="timeline-dot green"></div>
                            <div class="timeline-bar"></div>
                        </div>
                        <div class="timeline-content">
                            <span class="timeline-time green">09:00 - 10:00</span>
                            <h3>Registration & Inauguration</h3>
                            <p>Check-in followed by Hackathon Briefing.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-line">
                            <div class="timeline-dot"></div>
                            <div class="timeline-bar"></div>
                        </div>
                        <div class="timeline-content">
                            <span class="timeline-time blue">10:00 - 18:00</span>
                            <h3>Development & Mentoring</h3>
                            <p>Session 1 & 2. Lunch break at 13:00.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-line">
                            <div class="timeline-dot orange"></div>
                        </div>
                        <div class="timeline-content">
                            <span class="timeline-time orange">18:00 - 21:00</span>
                            <h3>Judging & Prizes</h3>
                            <p>Final presentations followed by Closing Ceremony.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Partners Section (rectangular logos) -->
        <section class="section">
            <div class="container">
                <div class="text-center" style="margin-bottom: 3rem;">
                    <h2 class="section-title"> Our <span class="accent">Partners</span></h2>
                </div>
                <div id="hosting-partners-container" class="flex justify-center gap-8" style="flex-wrap: wrap; min-height: 100px;">
                    <!-- Will be populated with partner cards (rectangle logo) -->
                </div>
            </div>
        </section>

        <!-- Sponsors Section (rectangular logos) -->
        <section class="section section-surface">
            <div class="container">
                <div class="text-center" style="margin-bottom: 3rem;">
                    <h2 class="section-title">Our <span class="accent-blue">Sponsors</span></h2>
                </div>
                <div id="sponsors-container">
                    <!-- Will be populated with sponsor cards (rectangle logo) -->
                </div>
            </div>
        </section>

        <section class="section" id="our-team">
            <div class="container">
                <div class="text-center" style="margin-bottom: 4rem;">
                    <h2 class="section-title">Our <span class="accent">Team Members</span></h2>
                    <p class="section-subtitle">Meet the visionaries behind AirFoxer Innovation Hackathon.</p>
                </div>
                <div id="team-members-container" class="grid grid-4">
                    <div class="empty-placeholder" style="grid-column: 1 / -1;">
                        Loading our amazing team...
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="contact">
            <div class="container">
                <div class="contact-grid">
                    <div>
                        <h2 class="section-title">Contact & <span class="accent">Venue</span></h2>
                        <p class="section-subtitle">Have questions or need assistance? Reach out to our organizing team.</p>
                        <div class="contact-items">
                            <div class="contact-item">
                                <div class="contact-icon orange"><i class="fa-solid fa-location-dot"></i></div>
                                <div>
                                    <h4>Location</h4>
                                    <p>Ground Floor, VTU-VRIF-TCOE Building,<br>1st Main Road, RHCS Layout,<br>Annapoorneshwari Nagar, Naagarabhaavi,<br>Bengaluru, Karnataka 560091</p>
                                    <a href="https://maps.app.goo.gl/TphfHrRhA7UkpnDD8?g_st=iw" target="_blank">View on Google Maps</a>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon blue"><i class="fa-solid fa-envelope"></i></div>
                                <div>
                                    <h4>Email Support</h4>
                                    <p>airfoxersmps@gmail.com</p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon green"><i class="fa-brands fa-whatsapp"></i></div>
                                <div>
                                    <h4>WhatsApp</h4>
                                    <p>Join our community for instant help.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="map-placeholder" id="venue-map" style="height: 450px; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);"></div>
                </div>
            </div>
        </section>

        <footer>
            <div class="container">
                <div class="footer-inner">
                    <div class="logo">
                        <img src="assets/AirFoxer.jpeg" alt="AirFoxer Logo" onerror="this.src='https://via.placeholder.com/36?text=AF'">
                        <span>AirFoxer Innovation</span>
                    </div>
                    <div class="footer-copy">&copy; 2026 AirFoxer Innovation Hackathon. All rights reserved.</div>
                    <div class="footer-socials">
                        <a href="#"><i class="fa-brands fa-github fa-lg"></i></a>
                        <a href="https://chat.whatsapp.com/JNX4osphTQw7PBHPDXdqDY" target="_blank"><i class="fa-brands fa-whatsapp fa-lg"></i></a>
                        <a href="#"><i class="fa-solid fa-users fa-lg"></i></a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- ==================== LEAD LOGIN VIEW ==================== -->
    <div id="lead-login-view" class="auth-container hidden">
        <div class="auth-card">
            <button class="close-btn" onclick="switchView('landing')"><i class="fa-solid fa-xmark"></i></button>
            <div class="auth-header">
                <div class="auth-icon orange"><i class="fa-solid fa-user-tie"></i></div>
                <h2 class="auth-title">Lead Access<br><span class="gradient-text">Portal</span></h2>
                <p class="auth-subtitle">Manage your team and project submissions.</p>
            </div>

            <button id="firebase-google-btn" class="google-btn">
                <img src="https://img.icons8.com/color/24/000000/google-logo.png" alt="Google">
                <span>Continue with Google</span>
            </button>

            <div class="divider">OR USE EMAIL</div>

            <form id="lead-email-form">
                <div class="form-group">
                    <label class="form-label"><i class="fa-solid fa-envelope"></i> Email Address</label>
                    <input type="email" class="form-input" id="lead-email" placeholder="lead@university.edu" required>
                </div>
                <div class="form-group">
                    <label class="form-label"><i class="fa-solid fa-lock"></i> Password</label>
                    <input type="password" class="form-input" id="lead-pass" placeholder="Enter password" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%; justify-content: center; padding: 14px;">
                    Enter Dashboard <i class="fa-solid fa-arrow-right-to-bracket"></i>
                </button>
            </form>

            <div style="text-align: center; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border);">
                <button class="nav-btn" onclick="switchView('landing')">
                    <i class="fa-solid fa-chevron-left"></i> Back to Main Page
                </button>
            </div>
        </div>
    </div>

    <!-- ==================== MEMBER LOGIN VIEW ==================== -->
    <div id="member-hub-auth-view" class="auth-container hidden">
        <div class="auth-card" style="text-align: center;">
            <button class="close-btn" onclick="switchView('landing')"><i class="fa-solid fa-xmark"></i></button>
            <div class="auth-header">
                <div class="auth-icon orange"><i class="fa-solid fa-certificate"></i></div>
                <h2 class="auth-title">Certification<br><span class="gradient-text">Notice</span></h2>
            </div>
            <div class="info-box" style="margin-bottom: 1.5rem;">
                <p style="color: var(--text-main); font-weight: 600; margin-bottom: 8px;">Member login is currently disabled.</p>
                <p style="color: var(--text-muted); font-size: 0.95rem;">
                    Please <strong>ask your Team Lead</strong> to download the certifications from their dashboard and share them with the squad.
                </p>
            </div>
        </div>
    </div>

    <!-- ==================== UPDATED REGISTER VIEW WITH MULTI PROBLEM SELECTION ==================== -->
    <div id="register-view" class="auth-container hidden">
        <div class="auth-card auth-card-wide">
            <button class="close-btn" onclick="switchView('landing')"><i class="fa-solid fa-xmark"></i></button>

            <div class="step-indicator">
                <span class="step step-done">Step 1: Auth âœ“</span>
                <i class="fa-solid fa-chevron-right" style="color: var(--text-light); font-size: 0.7rem;"></i>
                <span class="step step-active">Step 2: Team & Problems</span>
            </div>

            <div class="auth-header">
                <h2 class="auth-title">Finalize <span class="gradient-text">Team Registration</span></h2>
                <p class="auth-subtitle">Lead Account: <strong id="lead-display-info">loading...</strong></p>
            </div>

            <form id="register-form">
                <!-- Team identity row -->
                <div class="reg-grid" style="margin-bottom: 0.5rem;">
                    <div class="form-group">
                        <label class="form-label"><i class="fa-regular fa-flag"></i> Official Team Name</label>
                        <input type="text" class="form-input" id="reg-team-name" required placeholder="e.g., The Innovators">
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fa-regular fa-building"></i> College / Organization</label>
                        <input type="text" class="form-input" id="reg-org" required placeholder="University Name">
                    </div>
                </div>

                <!-- MEMBER CARDS -->
                <div class="reg-section-title"><i class="fa-solid fa-crown" style="color: var(--secondary);"></i> Team Lead & Members (with USN)</div>
                <div class="reg-grid">
                    <!-- Member 1 -->
                    <div class="member-card">
                        <span class="member-badge lead"><i class="fa-regular fa-star"></i> LEAD</span>
                        <label>Full name</label>
                        <input type="text" class="form-input" id="reg-m1-name" placeholder="Lead full name" required>
                        <div class="member-row">
                            <div style="flex:1"><label>Email</label><input type="email" class="form-input" id="reg-m1-email" placeholder="lead@college.edu" required></div>
                            <div style="flex:1"><label>Phone</label><input type="tel" class="form-input" id="reg-m1-phone" placeholder="9876543210" required></div>
                        </div>
                        <div class="usn-input"><label><i class="fa-solid fa-qrcode"></i> USN</label><input type="text" class="form-input" id="reg-m1-usn" placeholder="e.g., 1RN21CS001" required></div>
                    </div>
                    <!-- Member 2 -->
                    <div class="member-card">
                        <span class="member-badge">02</span>
                        <label>Full name</label><input type="text" class="form-input" id="reg-m2-name" placeholder="Member 2 name" required>
                        <div class="member-row"><div><label>Email</label><input type="email" class="form-input" id="reg-m2-email" placeholder="email" required></div><div><label>Phone</label><input type="tel" class="form-input" id="reg-m2-phone" placeholder="phone" required></div></div>
                        <div class="usn-input"><label>USN</label><input type="text" class="form-input" id="reg-m2-usn" placeholder="USN" required></div>
                    </div>
                    <!-- Member 3 -->
                    <div class="member-card">
                        <span class="member-badge">03</span>
                        <label>Full name</label><input type="text" class="form-input" id="reg-m3-name" placeholder="Member 3 name" required>
                        <div class="member-row"><div><label>Email</label><input type="email" class="form-input" id="reg-m3-email" placeholder="email" required></div><div><label>Phone</label><input type="tel" class="form-input" id="reg-m3-phone" placeholder="phone" required></div></div>
                        <div class="usn-input"><label>USN</label><input type="text" class="form-input" id="reg-m3-usn" placeholder="USN" required></div>
                    </div>
                    <!-- Member 4 -->
                    <div class="member-card">
                        <span class="member-badge">04</span>
                        <label>Full name</label><input type="text" class="form-input" id="reg-m4-name" placeholder="Member 4 name" required>
                        <div class="member-row"><div><label>Email</label><input type="email" class="form-input" id="reg-m4-email" placeholder="email" required></div><div><label>Phone</label><input type="tel" class="form-input" id="reg-m4-phone" placeholder="phone" required></div></div>
                        <div class="usn-input"><label>USN</label><input type="text" class="form-input" id="reg-m4-usn" placeholder="USN" required></div>
                    </div>
                    <!-- Member 5 -->
                    <div class="member-card">
                        <span class="member-badge">05</span>
                        <label>Full name</label><input type="text" class="form-input" id="reg-m5-name" placeholder="Member 5 name" required>
                        <div class="member-row"><div><label>Email</label><input type="email" class="form-input" id="reg-m5-email" placeholder="email" required></div><div><label>Phone</label><input type="tel" class="form-input" id="reg-m5-phone" placeholder="phone" required></div></div>
                        <div class="usn-input"><label>USN</label><input type="text" class="form-input" id="reg-m5-usn" placeholder="USN" required></div>
                    </div>
                </div>

                <!-- Theme Selection with Problem Statements (UPDATED FOR MULTI-SELECT) -->
                <div class="reg-section-title"><i class="fa-solid fa-rocket"></i> Problem Statements Selection</div>
                
                <!-- Theme Select -->
                <div class="form-group">
                    <label class="form-label">Select Theme</label>
                    <select class="form-select" id="reg-theme" required onchange="handleThemeChange(this.value)">
                        <option value="" disabled selected>âœ¨ Choose your hackathon theme</option>
                        <option value="Intelligent Energy">Intelligent Energy & Power Systems</option>
                        <option value="Sustainable Transport">Sustainable Transport (EV & Mobility)</option>
                        <option value="Connected Infrastructure">Connected Infrastructure (IoT & Digital Networks)</option>
                        <option value="Industry 5.0">Industry 5.0 (AI & Smart Automation)</option>
                        <option value="Open Innovation">Open Innovation (General Breakthroughs)</option>
                    </select>
                </div>

                <!-- Selected Problem Statements Display (UPDATED) -->
                <div id="selectedProblemsContainer" class="selected-problems-container" style="display: none;">
                    <div class="selected-problems-header">
                        <h4><i class="fa-solid fa-check-circle" style="color: var(--primary);"></i> Selected Problem Statements</h4>
                        <button type="button" class="change-problem-btn" onclick="openProblemModal()">
                            <i class="fa-solid fa-pen"></i> Change Selection
                        </button>
                    </div>
                    <div id="selectedProblemsList" class="selected-problems-list">
                        <!-- Selected problems will appear here -->
                    </div>
                </div>

                <!-- Hidden inputs for problem statements (UPDATED) -->
                <input type="hidden" id="selectedProblemIds" value="">
                <input type="hidden" id="selectedProblemTitles" value="">

                <div class="confirmation-box">
                    <input type="checkbox" id="confirm-check" required>
                    <label for="confirm-check" style="font-weight: 500;"><strong>Confirmation:</strong> I confirm that all names, emails, phones, USNs and the selected problem statements are correct. I understand that member login credentials will be generated after registration.</label>
                </div>

                <button type="submit" class="btn-primary" style="width: 100%; justify-content: center; padding: 18px; font-size: 1.2rem;">
                    Complete Registration <i class="fa-regular fa-circle-check"></i>
                </button>
            </form>
        </div>
    </div>

    <!-- ==================== DASHBOARD VIEW (UPDATED) ==================== -->
    <div id="dashboard-view" class="hidden">
        <div class="dashboard-container">
            <div class="dashboard-header">
                <div class="dash-info">
                    <div class="dash-icon"><i class="fa-solid fa-rocket"></i></div>
                    <div>
                        <h1 id="dash-team-name" class="dash-title">Loading...</h1>
                        <div>
                            <span class="dash-track-label">Selected Theme:</span>
                            <span id="dash-theme" class="dash-track">--</span>
                        </div>
                        <div style="margin-top: 0.5rem;">
                            <span class="dash-track-label">Problem Statements:</span>
                            <div id="dash-problems" style="margin-top: 0.25rem;">
                                <!-- Problem statements will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
                <div id="dash-status-badge" class="status-badge badge-pending">
                    <i class="fa-solid fa-clock"></i> Pending
                </div>
            </div>

            <div class="dash-grid">
                <div class="dash-card">
                    <div class="dash-card-title"><i class="fa-solid fa-users"></i> Team Roster</div>
                    <div id="team-members-list"></div>
                </div>

                <div class="dash-card" style="border-top: 3px solid var(--secondary);">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.25rem;">
                        <div>
                            <div class="dash-card-title" style="margin-bottom: 0;"><i class="fa-solid fa-key"></i> Access Portal</div>
                            <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 2px;">Generate credentials for member login.</p>
                        </div>
                        <button id="gen-btn" onclick="generateAccessCodes()" class="btn-primary" style="padding: 8px 16px; font-size: 0.75rem;">Generate</button>
                    </div>
                    <div class="creds-grid">
                        <div class="cred-box">
                            <span class="cred-label">Team Login Code</span>
                            <div id="display-team-code" class="cred-value">----</div>
                        </div>
                        <div class="cred-box">
                            <span class="cred-label">Access Password</span>
                            <div id="display-team-pass" class="cred-value">----</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="payment-card" style="border-top: 3px solid var(--primary);">
                <div class="payment-header">
                    <i class="fa-solid fa-credit-card"></i>
                    <div>
                        <h2>Payment & Verification</h2>
                        <p>Complete payment to get your team verified for the hackathon.</p>
                    </div>
                </div>

                <div class="payment-info">
                    <h4><i class="fa-solid fa-info-circle"></i> Payment Instructions</h4>

                    <div class="qr-wrapper">
                        <div class="qr-box">
                            <div id="payment-qr-code" style="width: 180px; height: 180px; margin: 0 auto;"></div>
                            <div class="qr-box-label">Scan to pay via UPI</div>
                        </div>
                    </div>

                    <ul>
                        <li><i class="fa-solid fa-rupee-sign"></i> <strong>Amount:</strong> &#8377;1500 per team</li>
                        <li><i class="fa-solid fa-mobile-alt"></i> <strong>UPI ID:</strong> <span style="color: var(--primary); font-weight: 700;">9108950128-2@ybl</span></li>
                        <li><i class="fa-solid fa-user-tie"></i> <strong>UPI Name:</strong> Shiva Bhalke</li>
                        <li><i class="fa-solid fa-clipboard-check"></i> <strong>Verification:</strong> Submit UTR below</li>
                    </ul>

                    <div class="payment-note">
                        <i class="fa-solid fa-lightbulb"></i> <strong>Note:</strong> UTR is a 12-digit reference number found in your payment receipt.
                    </div>
                </div>

                <div style="margin-top: 1.5rem;">
                    <h4 style="color: var(--text-main); margin-bottom: 1rem;">Payment Status</h4>
                    <div id="payment-status-display">
                        <p style="color: var(--text-muted);">No payment submitted yet.</p>
                    </div>
                </div>

                <div id="utr-submission-form" style="margin-top: 1.5rem; display: none;">
                    <h4 style="color: var(--text-main); margin-bottom: 1rem;">Submit UTR Number</h4>
                    <form id="utr-form">
                        <div class="form-group">
                            <label class="form-label">UTR (Unique Transaction Reference) Number</label>
                            <div class="utr-input-group">
                                <input type="text" class="form-input" id="utr-number" placeholder="Enter 12-digit UTR number" maxlength="12" required>
                                <button type="submit" class="btn-success" style="padding: 12px 24px; white-space: nowrap;">Submit UTR</button>
                            </div>
                            <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                                <i class="fa-solid fa-lightbulb"></i> UTR can be found in your bank transaction receipt.
                            </p>
                        </div>
                    </form>
                </div>

                <div id="payment-actions" class="payment-actions">
                    <button id="submit-payment-btn" class="btn-success" onclick="showUTRForm()">
                        <i class="fa-solid fa-money-bill-wave"></i> Submit Payment Details
                    </button>
                    <button class="btn-secondary" onclick="downloadPaymentReceipt()">
                        <i class="fa-solid fa-download"></i> Download Instructions
                    </button>
                </div>
            </div>

            <div id="qr-section" class="payment-card qr-section" style="display: none; border-top: 3px solid var(--success);">
                <div class="payment-header">
                    <i class="fa-solid fa-qrcode" style="color: var(--success);"></i>
                    <div>
                        <h2>Digital Pass<b>Entry pass</b></h2>
                        <p>Your team is verified! Download the QR code for event entry.</p>
                    </div>
                </div>
                <div class="qr-container">
                    <div id="qr-code" class="qr-code"></div>
                    <div class="qr-details">
                        <h4 id="qr-team-name">Team Name</h4>
                        <p id="qr-team-code">Team Code: ---</p>
                        <p id="qr-event-date">Event Date: March 6, 2026</p>
                        <p style="color: var(--text-muted); font-size: 0.8rem; margin-top: 1rem;">
                            <i class="fa-solid fa-info-circle"></i> Show this QR code at the registration desk.
                        </p>
                    </div>
                    <button class="btn-success" onclick="downloadQRCode()" style="margin-top: 1.5rem;">
                        <i class="fa-solid fa-download"></i> Download QR Code
                    </button>
                </div>
            </div>

            <div class="payment-card" style="border-top: 3px solid var(--secondary);">
                <div class="payment-header">
                    <i class="fa-solid fa-cloud-arrow-up" style="color: var(--secondary);"></i>
                    <div>
                        <h2>Project Submission</h2>
                        <p>Add all files, reports, and PPT to a Google Drive folder and submit the link below.</p>
                    </div>
                </div>
                <form id="submission-form" class="submission-form">
                    <div class="form-group">
                        <label class="form-label">Project Files <span style="color: var(--text-light); font-size: 0.65rem;">(Disabled - use Drive link)</span></label>
                        <input type="file" class="form-input" id="sub-files" disabled>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Project Photos <span style="color: var(--text-light); font-size: 0.65rem;">(Disabled - use Drive link)</span></label>
                        <input type="file" class="form-input" id="sub-photos" multiple accept="image/*" disabled>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label">Google Drive / Cloud Link (required)</label>
                        <textarea class="form-input" id="sub-links" placeholder="Google Drive link containing all project files, reports, PPT, etc." rows="3" required></textarea>
                    </div>
                    <div class="full-width">
                        <button type="button" id="sub-btn" class="btn-primary" style="width: 100%; justify-content: center;" onclick="handleProjectSubmission()">
                            <span>Submit Project Link</span>
                        </button>
                    </div>
                </form>
            </div>

            <div class="payment-card" style="border-top: 3px solid var(--primary);">
                <div class="payment-header">
                    <i class="fa-solid fa-award" style="color: var(--primary);"></i>
                    <div>
                        <h2>Team Certifications</h2>
                        <p>Information about participation certificates.</p>
                    </div>
                </div>
                <div class="cert-placeholder">
                    <i class="fa-solid fa-certificate"></i>
                    <p>Certificates will be issued after March 9th, 2026</p>
                    <p>If possible, certificates will be sent via email to all registered team members.</p>
                </div>
            </div>

            <div style="text-align: center; margin: 3rem 0;">
                <button class="btn-secondary" onclick="switchView('landing')">
                    <i class="fa-solid fa-arrow-left"></i> Back to Landing Page
                </button>
            </div>
        </div>
    </div>

    <!-- ==================== NOTIFICATIONS MODAL ==================== -->
    <div id="all-notifications-modal" class="modal-backdrop" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-bell"></i> All Notifications</h2>
                <button class="modal-close" onclick="closeAllNotificationsModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body" id="all-notifications-list">
                <div style="text-align: center; padding: 40px;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 24px; color: var(--primary);"></i>
                    <p style="margin-top: 16px; color: var(--text-muted);">Loading notifications...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // FIREBASE CONFIGURATION
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyCipUkkNySML4U1VI2fH1RyWgXYqvDMPRQ",
            authDomain: "airfoxer-hackathon.firebaseapp.com",
            projectId: "airfoxer-hackathon",
            storageBucket: "airfoxer-hackathon.firebasestorage.app",
            messagingSenderId: "51363230854",
            appId: "1:51363230854:web:4a33c8a92ebebb41b5cd07"
        };

        // ============================================
        // INITIALIZE FIREBASE
        // ============================================
        let db, auth, storage;
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            auth = firebase.auth();
            storage = firebase.storage();
            db.enablePersistence().catch(() => {});
        } catch (error) {
            console.error("Firebase initialization error:", error);
        }

        // ============================================
        // DATABASE COLLECTIONS
        // ============================================
        const COLLECTIONS = {
            TEAMS: 'teams',
            USERS: 'users',
            NOTIFICATIONS: 'notifications',
            SETTINGS: 'settings',
            SUBMISSIONS: 'submissions',
            PAYMENTS: 'payments',
            PROBLEM_STATEMENTS: 'problem_statements'
        };

        // ============================================
        // GLOBAL SETTINGS
        // ============================================
        let appSettings = {
            eventDate: 'March 6, 2026 09:00:00',
            deadlineDate: '2026-02-22',
            maxTeams: 50,
            registrationOpen: true,
            themes: []
        };

        // Problem statement state (UPDATED FOR MULTI-SELECT)
        let currentThemeProblems = [];
        let selectedProblemIds = new Set(); // Store multiple IDs
        let selectedTheme = null;

        // ============================================
        // AUTHENTICATION
        // ============================================
        let currentUser = null;

        auth.onAuthStateChanged(async (user) => {
            currentUser = user;
            if (user) {
                const userDoc = await db.collection(COLLECTIONS.USERS).doc(user.uid).get();
                if (!userDoc.exists) {
                    await createUserRecord(user);
                }
                const userData = userDoc.exists ? userDoc.data() : { role: 'lead' };
                handleAuthSuccess(userData.role || 'lead', user.email || user.phoneNumber);
                
                // Update lead display info in registration view
                const leadDisplay = document.getElementById('lead-display-info');
                if (leadDisplay) leadDisplay.innerText = user.email || 'Lead';
            } else {
                updateAuthUI();
                const leadDisplay = document.getElementById('lead-display-info');
                if (leadDisplay) leadDisplay.innerText = 'not logged in';
            }
        });

        // ============================================
        // VIEW CONTROLLER
        // ============================================
        async function switchView(v, sectionId = null) {
            const views = ['landing', 'lead-login', 'member-hub-auth', 'register', 'dashboard'];
            views.forEach(id => {
                const el = document.getElementById(id + '-view');
                if (el) {
                    el.classList.add('hidden');
                    el.style.display = '';
                }
            });
            const targetEl = document.getElementById(v + '-view');
            if (targetEl) {
                targetEl.classList.remove('hidden');
            }
            if (v === 'dashboard') loadDashboardData();
            if (v === 'landing' && sectionId) {
                setTimeout(() => {
                    const element = document.getElementById(sectionId);
                    if (element) element.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            } else {
                window.scrollTo(0, 0);
            }
        }

        async function handleAuthSuccess(role, identifier = "") {
            localStorage.setItem('userRole', role);
            localStorage.setItem('userIdentifier', identifier);
            updateAuthUI();
            if (role === 'lead') {
                try {
                    const userDoc = await db.collection(COLLECTIONS.USERS).doc(currentUser.uid).get();
                    if (userDoc.exists && userDoc.data().teamId) {
                        notify("Welcome back, Lead!", "success");
                        switchView('dashboard');
                    } else {
                        notify("Access Verified. Please register your team.", "success");
                        switchView('register');
                    }
                } catch (e) {
                    console.error(e);
                    switchView('landing');
                }
            }
        }

        async function createUserRecord(user) {
            try {
                await db.collection(COLLECTIONS.USERS).doc(user.uid).set({
                    uid: user.uid,
                    email: user.email || null,
                    phoneNumber: user.phoneNumber || null,
                    displayName: user.displayName || null,
                    role: 'lead',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                });
            } catch (error) {
                console.error("Error creating user record:", error);
            }
        }

        // ============================================
        // PROBLEM STATEMENT MODAL FUNCTIONS (UPDATED FOR MULTI-SELECT)
        // ============================================
        async function handleThemeChange(theme) {
            selectedTheme = theme;
            
            // Clear previous selections
            selectedProblemIds.clear();
            document.getElementById('selectedProblemsContainer').style.display = 'none';
            document.getElementById('selectedProblemIds').value = '';
            document.getElementById('selectedProblemTitles').value = '';
            document.getElementById('selectedCount').textContent = '0';
            document.getElementById('confirmProblemBtn').disabled = true;
            
            // Load problems for selected theme
            await loadProblemsForTheme(theme);
            openProblemModal();
        }

        async function loadProblemsForTheme(theme) {
            try {
                const problemsRef = db.collection(COLLECTIONS.PROBLEM_STATEMENTS);
                const snapshot = await problemsRef.where('theme', '==', theme).where('active', '==', true).get();
                
                currentThemeProblems = [];
                const problemList = document.getElementById('problemList');
                
                if (snapshot.empty) {
                    problemList.innerHTML = '<div class="empty-placeholder">No problem statements available for this theme yet.</div>';
                    document.getElementById('confirmProblemBtn').disabled = true;
                    return;
                }

                let html = '';
                snapshot.forEach(doc => {
                    const problem = doc.data();
                    problem.id = doc.id;
                    currentThemeProblems.push(problem);
                    
                    html += `
                        <div class="problem-item" onclick="selectProblem('${doc.id}')" id="problem-${doc.id}">
                            <div class="problem-title">${problem.title}</div>
                            <div class="problem-description">${problem.description}</div>
                            <div class="problem-meta">
                                <span><i class="fa-regular fa-clock"></i> ${problem.duration || '24 hours'}</span>
                                <span><i class="fa-regular fa-file-lines"></i> ${problem.category || 'Technical'}</span>
                            </div>
                        </div>
                    `;
                });
                
                problemList.innerHTML = html;
                document.getElementById('modalThemeTitle').innerHTML = `Select Problem Statements - <span style="color: var(--primary);">${theme}</span>`;
                document.getElementById('selectedThemeName').innerText = theme;
                document.getElementById('selectedThemeBadge').style.display = 'inline-flex';
                
            } catch (error) {
                console.error("Error loading problems:", error);
                document.getElementById('problemList').innerHTML = '<div class="empty-placeholder">Error loading problem statements.</div>';
            }
        }

        // UPDATED: Multi-select problem function
        function selectProblem(problemId) {
            const problemElement = document.getElementById(`problem-${problemId}`);
            
            if (selectedProblemIds.has(problemId)) {
                // Deselect if already selected
                problemElement.classList.remove('selected');
                selectedProblemIds.delete(problemId);
            } else {
                // Check if we've reached the limit of 5
                if (selectedProblemIds.size >= 5) {
                    notify("You can only select up to 5 problem statements", "warning");
                    return;
                }
                // Select new problem
                problemElement.classList.add('selected');
                selectedProblemIds.add(problemId);
            }
            
            // Update selection counter
            document.getElementById('selectedCount').textContent = selectedProblemIds.size;
            
            // Enable/disable confirm button based on selection
            document.getElementById('confirmProblemBtn').disabled = selectedProblemIds.size === 0;
        }

        // UPDATED: Confirm multiple problem selections
        function confirmProblemSelection() {
            if (selectedProblemIds.size === 0) {
                notify("Please select at least one problem statement", "error");
                return;
            }

            // Get all selected problems
            const selectedProblems = currentThemeProblems.filter(p => selectedProblemIds.has(p.id));
            
            // Update display
            const problemsList = document.getElementById('selectedProblemsList');
            problemsList.innerHTML = selectedProblems.map((problem, index) => `
                <div class="selected-problem-item">
                    <div class="selected-problem-number">${index + 1}</div>
                    <div class="selected-problem-content">
                        <h5>${problem.title}</h5>
                        <p>${problem.description.substring(0, 100)}${problem.description.length > 100 ? '...' : ''}</p>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('selectedProblemsContainer').style.display = 'block';
            
            // Set hidden inputs with JSON strings
            document.getElementById('selectedProblemIds').value = JSON.stringify(Array.from(selectedProblemIds));
            document.getElementById('selectedProblemTitles').value = JSON.stringify(selectedProblems.map(p => p.title));
            
            // Close modal
            closeProblemModal();
            
            notify(`${selectedProblems.length} problem statement(s) selected successfully!`, "success");
        }

        function openProblemModal() {
            document.getElementById('problemModal').style.display = 'flex';
        }

        function closeProblemModal() {
            document.getElementById('problemModal').style.display = 'none';
        }

        // ============================================
        // TEAM REGISTRATION (UPDATED WITH MULTI PROBLEM STATEMENTS)
        // ============================================
        const registerForm = document.getElementById('register-form');
        if (registerForm) {
            registerForm.onsubmit = async (e) => {
                e.preventDefault();
                if (!currentUser) {
                    notify("Please login first", "error");
                    switchView('lead-login');
                    return;
                }

                // Validate problem statements selection
                const problemIds = document.getElementById('selectedProblemIds').value;
                const problemTitles = document.getElementById('selectedProblemTitles').value;
                
                if (!problemIds || !problemTitles) {
                    notify("Please select problem statements for your theme", "error");
                    return;
                }

                // Parse the JSON strings back to arrays
                const selectedProblemIdsArray = JSON.parse(problemIds);
                const selectedProblemTitlesArray = JSON.parse(problemTitles);

                if (selectedProblemIdsArray.length === 0) {
                    notify("Please select at least one problem statement", "error");
                    return;
                }

                const submitBtn = registerForm.querySelector('button[type="submit"]');
                const originalText = submitBtn.innerHTML;
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Registering...';
                
                try {
                    // Check if team already exists
                    const existingTeams = await db.collection(COLLECTIONS.TEAMS)
                        .where('leadId', '==', currentUser.uid).get();
                    if (!existingTeams.empty) {
                        notify("You already have a registered team!", "error");
                        switchView('dashboard');
                        return;
                    }

                    // Build members array with USN
                    const members = [
                        { name: document.getElementById('reg-m1-name').value.trim(), role: 'lead', email: document.getElementById('reg-m1-email').value.trim(), phone: document.getElementById('reg-m1-phone').value.trim(), usn: document.getElementById('reg-m1-usn').value.trim() },
                        { name: document.getElementById('reg-m2-name').value.trim(), role: 'member', email: document.getElementById('reg-m2-email').value.trim(), phone: document.getElementById('reg-m2-phone').value.trim(), usn: document.getElementById('reg-m2-usn').value.trim() },
                        { name: document.getElementById('reg-m3-name').value.trim(), role: 'member', email: document.getElementById('reg-m3-email').value.trim(), phone: document.getElementById('reg-m3-phone').value.trim(), usn: document.getElementById('reg-m3-usn').value.trim() },
                        { name: document.getElementById('reg-m4-name').value.trim(), role: 'member', email: document.getElementById('reg-m4-email').value.trim(), phone: document.getElementById('reg-m4-phone').value.trim(), usn: document.getElementById('reg-m4-usn').value.trim() },
                        { name: document.getElementById('reg-m5-name').value.trim(), role: 'member', email: document.getElementById('reg-m5-email').value.trim(), phone: document.getElementById('reg-m5-phone').value.trim(), usn: document.getElementById('reg-m5-usn').value.trim() }
                    ];

                    const teamData = {
                        teamName: document.getElementById('reg-team-name').value.trim(),
                        organization: document.getElementById('reg-org').value.trim(),
                        theme: document.getElementById('reg-theme').value,
                        problemIds: selectedProblemIdsArray, // Store as array
                        problemTitles: selectedProblemTitlesArray, // Store as array
                        leadId: currentUser.uid,
                        leadEmail: currentUser.email,
                        status: 'pending',
                        paymentStatus: 'pending',
                        registrationDate: firebase.firestore.FieldValue.serverTimestamp(),
                        codesGenerated: false,
                        certsReleased: false,
                        projectSubmitted: false,
                        members: members
                    };

                    const docRef = await db.collection(COLLECTIONS.TEAMS).add(teamData);
                    await db.collection(COLLECTIONS.USERS).doc(currentUser.uid).update({
                        teamId: docRef.id, role: 'lead'
                    });

                    notify("Team registered successfully with problem statements!", "success");
                    setTimeout(() => switchView('dashboard'), 500);
                } catch (error) {
                    console.error("Registration error:", error);
                    notify("Registration failed. Please try again.", "error");
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalText;
                }
            };
        }

        // ============================================
        // DASHBOARD (UPDATED TO SHOW MULTIPLE PROBLEM STATEMENTS)
        // ============================================
        async function loadDashboardData() {
            if (!currentUser) return;
            try {
                const teamsSnapshot = await db.collection(COLLECTIONS.TEAMS)
                    .where('leadId', '==', currentUser.uid).limit(1).get();
                if (teamsSnapshot.empty) {
                    document.getElementById('dash-team-name').textContent = "No team registered";
                    return;
                }
                const teamDoc = teamsSnapshot.docs[0];
                const teamData = teamDoc.data();
                teamData.id = teamDoc.id;

                document.getElementById('dash-team-name').textContent = teamData.teamName || 'Unnamed Team';
                document.getElementById('dash-theme').textContent = teamData.theme || 'Not selected';
                
                // UPDATED: Display multiple problem statements
                const problemsContainer = document.getElementById('dash-problems');
                if (teamData.problemTitles && teamData.problemTitles.length > 0) {
                    problemsContainer.innerHTML = teamData.problemTitles.map((title, index) => `
                        <div style="background: var(--bg-surface); padding: 0.5rem; margin-bottom: 0.5rem; border-radius: 8px; border-left: 3px solid var(--secondary);">
                            <span style="color: var(--secondary); font-weight: 600;">${index + 1}.</span>
                            <span style="color: var(--text-main); font-size: 0.85rem;">${title}</span>
                        </div>
                    `).join('');
                } else {
                    problemsContainer.innerHTML = '<span class="dash-track" style="color: var(--secondary);">No problems selected</span>';
                }

                const statusBadge = document.getElementById('dash-status-badge');
                if (statusBadge) {
                    const status = teamData.status || 'pending';
                    const paymentStatus = teamData.paymentStatus || 'pending';
                    if (status === 'verified' && paymentStatus === 'verified') {
                        statusBadge.className = 'status-badge badge-verified';
                        statusBadge.innerHTML = '<i class="fa-solid fa-check"></i> Verified';
                    } else if (paymentStatus === 'pending') {
                        statusBadge.className = 'status-badge badge-pending';
                        statusBadge.innerHTML = '<i class="fa-solid fa-clock"></i> Payment Pending';
                    } else if (paymentStatus === 'rejected') {
                        statusBadge.className = 'status-badge badge-rejected';
                        statusBadge.innerHTML = '<i class="fa-solid fa-times"></i> Payment Rejected';
                    } else {
                        statusBadge.className = 'status-badge badge-pending';
                        statusBadge.innerHTML = '<i class="fa-solid fa-clock"></i> Pending';
                    }
                }

                const membersList = document.getElementById('team-members-list');
                if (membersList && teamData.members) {
                    membersList.innerHTML = teamData.members.map((member, index) => `
                        <div class="roster-member">
                            <div class="roster-info">
                                <span class="roster-name">${member.name || 'Member'}</span>
                                <span class="roster-email">${member.email || 'No email'}</span>
                                <span class="roster-email" style="color: var(--primary);">USN: ${member.usn || 'N/A'}</span>
                            </div>
                            <span class="roster-badge ${index === 0 ? 'lead' : ''}">${index === 0 ? 'Lead' : 'Member'}</span>
                        </div>
                    `).join('');
                }

                if (teamData.codesGenerated) {
                    const codeEl = document.getElementById('display-team-code');
                    const passEl = document.getElementById('display-team-pass');
                    if (codeEl) codeEl.innerText = teamData.teamCode || '----';
                    if (passEl) passEl.innerText = teamData.teamPassword || "----";
                    const genBtn = document.getElementById('gen-btn');
                    if (genBtn) genBtn.style.display = 'none';
                }

                await loadPaymentStatus(teamData.id);
                generatePaymentQRCode();
                // Generate QR code if already verified
                if (teamData.status === 'verified' && teamData.paymentStatus === 'verified') {
                    generateQRCode(teamData);
                }
            } catch (error) {
                console.error("Dashboard Error:", error);
                notify("Failed to sync dashboard data", "error");
            }
        }

        // ============================================
        // PAYMENT SYSTEM FUNCTIONS (keep existing)
        // ============================================
        async function loadPaymentStatus(teamId) {
            try {
                const paymentsSnapshot = await db.collection(COLLECTIONS.PAYMENTS)
                    .where('teamId', '==', teamId).get();
                if (paymentsSnapshot.empty) {
                    document.getElementById('payment-status-display').innerHTML = `
                        <div class="payment-status-row">
                            <i class="fa-solid fa-clock status-icon pending"></i>
                            <div>
                                <strong>No Payment Submitted</strong>
                                <p>Please submit your payment UTR to get verified.</p>
                            </div>
                        </div>`;
                    document.getElementById('utr-submission-form').style.display = 'block';
                    document.getElementById('submit-payment-btn').style.display = 'none';
                    return null;
                }
                let latestPayment = null, latestDate = null;
                paymentsSnapshot.forEach(doc => {
                    const payment = doc.data();
                    if (!latestPayment || (payment.submittedAt && payment.submittedAt.toDate().getTime() > latestDate)) {
                        latestPayment = payment;
                        latestDate = payment.submittedAt ? payment.submittedAt.toDate().getTime() : 0;
                    }
                });
                const payment = latestPayment;
                let statusHTML = '', badgeClass = '';
                switch (payment.status) {
                    case 'pending':
                        statusHTML = `<div class="payment-status-row"><i class="fa-solid fa-clock status-icon pending"></i><div><strong>Payment Under Review</strong><p>UTR: ${payment.utrNumber}<br>Submitted: ${formatDate(payment.submittedAt)}</p></div></div>`;
                        badgeClass = 'badge-pending';
                        break;
                    case 'verified':
                        statusHTML = `<div class="payment-status-row"><i class="fa-solid fa-check-circle status-icon verified"></i><div><strong>Payment Verified</strong><p>UTR: ${payment.utrNumber}<br>Verified: ${formatDate(payment.verifiedAt)}</p></div></div>`;
                        badgeClass = 'badge-verified';
                        break;
                    case 'rejected':
                        statusHTML = `<div class="payment-status-row"><i class="fa-solid fa-times-circle status-icon rejected"></i><div><strong>Payment Rejected</strong><p>Reason: ${payment.rejectionReason || 'Not specified'}<br>Please submit a new UTR.</p></div></div>`;
                        badgeClass = 'badge-rejected';
                        document.getElementById('utr-submission-form').style.display = 'block';
                        break;
                }
                document.getElementById('payment-status-display').innerHTML = statusHTML;
                const badge = document.getElementById('dash-status-badge');
                badge.className = `status-badge ${badgeClass}`;
                badge.innerHTML = `<i class="fa-solid fa-${payment.status === 'verified' ? 'check' : payment.status === 'rejected' ? 'times' : 'clock'}"></i> ${payment.status.charAt(0).toUpperCase() + payment.status.slice(1)}`;
                return payment;
            } catch (error) {
                console.error("Error loading payment status:", error);
                return null;
            }
        }

        function showUTRForm() {
            document.getElementById('utr-submission-form').style.display = 'block';
            document.getElementById('submit-payment-btn').style.display = 'none';
        }

        const utrForm = document.getElementById('utr-form');
        if (utrForm) {
            utrForm.onsubmit = async (e) => {
                e.preventDefault();
                if (!currentUser) { notify("Please login first", "error"); return; }
                const utrNumber = document.getElementById('utr-number').value.trim();
                if (utrNumber.length < 10) { notify("Please enter a valid UTR number (minimum 10 digits)", "error"); return; }
                try {
                    showLoading(true);
                    const teamsSnapshot = await db.collection(COLLECTIONS.TEAMS)
                        .where('leadId', '==', currentUser.uid).limit(1).get();
                    if (teamsSnapshot.empty) { notify("Team not found", "error"); return; }
                    const teamDoc = teamsSnapshot.docs[0];
                    const teamId = teamDoc.id;
                    const teamName = teamDoc.data().teamName;
                    await db.collection(COLLECTIONS.PAYMENTS).add({
                        teamId, teamName, utrNumber, status: 'pending', amount: 1500, currency: 'INR',
                        submittedBy: currentUser.uid, submittedByEmail: currentUser.email,
                        submittedAt: firebase.firestore.FieldValue.serverTimestamp(),
                        verifiedAt: null, verifiedBy: null, rejectionReason: null
                    });
                    await db.collection(COLLECTIONS.TEAMS).doc(teamId).update({
                        paymentStatus: 'pending', lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    document.getElementById('utr-number').value = '';
                    document.getElementById('utr-submission-form').style.display = 'none';
                    notify("UTR submitted successfully! Admin will verify your payment soon.", "success");
                    loadPaymentStatus(teamId);
                    await createAdminNotification('New Payment Submission', `Team "${teamName}" submitted UTR: ${utrNumber}`, 'payment');
                } catch (error) {
                    console.error("Error submitting UTR:", error);
                    notify("Failed to submit UTR. Please try again.", "error");
                } finally {
                    showLoading(false);
                }
            };
        }

        async function createAdminNotification(title, message, type) {
            try {
                await db.collection(COLLECTIONS.NOTIFICATIONS).add({
                    title, message, type, isPublic: false, isAdmin: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(), read: false
                });
            } catch (error) {
                console.error("Error creating admin notification:", error);
            }
        }

        function downloadPaymentReceipt() {
            const receiptContent = `
AIRFOXER INNOVATION HACKATHON 2026
====================================

PAYMENT INSTRUCTIONS
--------------------
Amount: Rs.1500 per team

METHOD: UPI Payment (Preferred)
--------------------------------
UPI ID: 9108950128-2@ybl
UPI Name: Shiva Bhalke

INSTRUCTIONS:
1. Scan QR code in dashboard for instant UPI payment
2. After payment, save the transaction receipt
3. Note the 12-digit UTR number from receipt
4. Submit UTR in dashboard for verification
5. If you have paid on Unstop, please submit the UTR as well.
6. Verification takes 24-48 hours

CONTACT: airfoxersmps@gmail.com
WhatsApp: https://chat.whatsapp.com/JNX4osphTQw7PBHPDXdqDY

Generated: ${new Date().toLocaleDateString()}
`;
            const blob = new Blob([receiptContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'AirFoxer_Payment_Instructions.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // ============================================
        // QR CODE GENERATION
        // ============================================
        function generateQRCode(teamData) {
            const qrSection = document.getElementById('qr-section');
            if (!qrSection) return;
            if (teamData.status === 'verified' && teamData.paymentStatus === 'verified') {
                qrSection.style.display = 'block';
                const qrContainer = document.getElementById('qr-code');
                if (qrContainer) qrContainer.innerHTML = '';
                const qrData = JSON.stringify({
                    t: teamData.id.substring(0, 10), n: teamData.teamName.substring(0, 20),
                    c: teamData.teamCode || 'N/A', e: "AF26", v: 1
                });
                try {
                    new QRCode(qrContainer, { text: qrData, width: 200, height: 200, colorDark: "#000000", colorLight: "#ffffff", correctLevel: QRCode.CorrectLevel.H });
                } catch (error) {
                    qrContainer.innerHTML = `<div class="qr-error">QR Code Error: ${error.message}</div>`;
                }
                document.getElementById('qr-team-name').textContent = teamData.teamName;
                document.getElementById('qr-team-code').textContent = `Team Code: ${teamData.teamCode || 'N/A'}`;
            } else {
                qrSection.style.display = 'none';
            }
        }

        function generatePaymentQRCode() {
            const qrContainer = document.getElementById('payment-qr-code');
            if (!qrContainer) return;
            qrContainer.innerHTML = '';
            try {
                new QRCode(qrContainer, {
                    text: "upi://pay?pa=9108950128-2@ybl&pn=ShivaBhalke&am=1500&tn=AirFoxerHack2026",
                    width: 180, height: 180, colorDark: "#000000", colorLight: "#ffffff", correctLevel: QRCode.CorrectLevel.H
                });
            } catch (error) {
                qrContainer.innerHTML = `<div class="qr-error">QR Error: ${error.message}</div>`;
            }
        }

        function downloadQRCode() {
            const qrCanvas = document.querySelector('#qr-code canvas');
            if (!qrCanvas) { notify("QR code not available yet", "error"); return; }
            const link = document.createElement('a');
            link.download = `AirFoxer_Pass_${document.getElementById('qr-team-name').textContent.replace(/\s+/g, '_')}.png`;
            link.href = qrCanvas.toDataURL('image/png');
            link.click();
        }

        async function generateAccessCodes() {
            if (!currentUser) return;
            try {
                const genBtn = document.getElementById('gen-btn');
                genBtn.innerText = "Generating...";
                genBtn.disabled = true;
                const snap = await db.collection(COLLECTIONS.TEAMS)
                    .where('leadId', '==', currentUser.uid).get();
                if (snap.empty) return;
                const teamDoc = snap.docs[0];
                const teamName = teamDoc.data().teamName;
                const code = teamName.replace(/\s/g, '').substring(0, 4).toUpperCase() + "-" + Math.floor(1000 + Math.random() * 9000);
                const pass = Math.random().toString(36).substring(2, 8).toUpperCase();
                await db.collection(COLLECTIONS.TEAMS).doc(teamDoc.id).update({
                    teamCode: code, teamPassword: pass, codesGenerated: true,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                });
                document.getElementById('display-team-code').innerText = code;
                document.getElementById('display-team-pass').innerText = pass;
                genBtn.style.display = 'none';
                notify("Credentials Generated!", "success");
            } catch (e) {
                console.error(e);
                notify("Failed to generate keys", "error");
                document.getElementById('gen-btn').disabled = false;
                document.getElementById('gen-btn').innerText = "Generate";
            }
        }

        async function handleProjectSubmission() {
            if (!currentUser) { notify("Please login first", "error"); return; }
            try {
                const subBtn = document.getElementById('sub-btn');
                subBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Submitting...';
                subBtn.disabled = true;
                const links = document.getElementById('sub-links').value.trim();
                if (!links) {
                    notify("Please enter your Google Drive link", "error");
                    subBtn.innerHTML = '<span>Submit Project Link</span>';
                    subBtn.disabled = false;
                    return;
                }
                const teamsSnapshot = await db.collection(COLLECTIONS.TEAMS)
                    .where('leadId', '==', currentUser.uid).limit(1).get();
                if (teamsSnapshot.empty) { notify("Team not found", "error"); return; }
                const teamDoc = teamsSnapshot.docs[0];
                await db.collection(COLLECTIONS.TEAMS).doc(teamDoc.id).update({
                    projectSubmitted: true, submissionLinks: links,
                    submissionDate: firebase.firestore.FieldValue.serverTimestamp(),
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                });
                await db.collection(COLLECTIONS.SUBMISSIONS).add({
                    teamId: teamDoc.id, teamName: teamDoc.data().teamName,
                    links, submittedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                notify("Project link submitted successfully!", "success");
                document.getElementById('sub-links').value = '';
            } catch (error) {
                console.error("Submission error:", error);
                notify("Failed to submit project link", "error");
            } finally {
                const subBtn = document.getElementById('sub-btn');
                subBtn.innerHTML = '<span>Submit Project Link</span>';
                subBtn.disabled = false;
            }
        }

        // ============================================
        // NOTIFICATIONS
        // ============================================
        async function loadUserNotifications() {
            try {
                const notifList = document.getElementById('notif-list');
                if (!notifList) return;
                const unsubscribe = db.collection(COLLECTIONS.NOTIFICATIONS)
                    .where('isPublic', '==', true).orderBy('createdAt', 'desc').limit(10)
                    .onSnapshot((snapshot) => {
                        if (snapshot.empty) {
                            notifList.innerHTML = '<div class="notif-item">No notifications yet</div>';
                            updateNotificationBadge(0);
                            return;
                        }
                        let html = '';
                        snapshot.forEach(doc => {
                            const n = doc.data();
                            html += `<div class="notif-item"><strong>${n.title || 'Notification'}</strong><p>${n.message || ''}</p><small>${formatDate(n.createdAt)}</small></div>`;
                        });
                        notifList.innerHTML = html;
                        updateNotificationBadge(snapshot.size);
                    }, () => {
                        notifList.innerHTML = '<div class="notif-item">Error loading notifications</div>';
                    });
                window.notificationUnsubscribe = unsubscribe;
            } catch (error) {
                console.error("Error setting up notification listener:", error);
            }
        }

        function updateNotificationBadge(count) {
            const notifBadge = document.getElementById('notif-badge');
            if (!notifBadge) return;
            if (count > 0) {
                notifBadge.classList.remove('hidden');
                notifBadge.textContent = count > 9 ? '9+' : count;
            } else {
                notifBadge.classList.add('hidden');
            }
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function showLoading(show) {
            const btn = document.querySelector('.btn-primary:disabled');
            if (btn) {
                btn.innerHTML = show
                    ? '<i class="fa-solid fa-spinner fa-spin"></i> Processing...'
                    : btn.getAttribute('data-original-text') || 'Submit';
            }
        }

        async function logActivity(action, details) {
            try {
                await db.collection('logs').add({
                    action,
                    details,
                    userId: currentUser?.uid || 'anonymous',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    ip: 'web-client'
                });
            } catch (error) {
                console.error("Error logging activity:", error);
            }
        }

        function formatDate(timestamp) {
            if (!timestamp) return 'N/A';
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            return date.toLocaleDateString('en-US', {
                year: 'numeric', month: 'short', day: 'numeric',
                hour: '2-digit', minute: '2-digit'
            });
        }

        function notify(msg, type) {
            const box = document.getElementById('message-box');
            box.innerText = msg;
            box.style.display = 'block';
            box.className = `toast toast-${type}`;
            setTimeout(() => { box.style.display = 'none'; }, 4000);
        }

        // ============================================
        // LOAD LANDING PAGE DATA (Partners & Sponsors with rectangle logos)
        // ============================================
        async function loadHostingPartners() {
            try {
                const partnersSnap = await db.collection('hostingPartners')
                    .where('active', '==', true).orderBy('order', 'asc').get();
                const container = document.getElementById('hosting-partners-container');
                if (!container) return;
                if (partnersSnap.empty) {
                    container.innerHTML = '<div class="empty-placeholder"><p>Hosting Partners to be announced</p></div>';
                } else {
                    let html = '';
                    partnersSnap.forEach(doc => {
                        const p = doc.data();
                        html += `<div class="partner-card">
                            <div class="partner-logo">${p.logoUrl ? `<img src="${p.logoUrl}" alt="${p.name}">` : '<i class="fas fa-building"></i>'}</div>
                            <h3>${p.name}</h3>
                            ${p.description ? `<p>${p.description}</p>` : ''}
                        </div>`;
                    });
                    container.innerHTML = html;
                }
            } catch (error) {
                console.error("Error loading hosting partners:", error);
            }
        }

        async function loadSponsors() {
            try {
                const sponsorsSnap = await db.collection('sponsors')
                    .where('active', '==', true).orderBy('order', 'asc').get();
                const container = document.getElementById('sponsors-container');
                if (!container) return;
                if (sponsorsSnap.empty) {
                    container.innerHTML = '<div class="empty-placeholder"><p>Sponsors & Partners to be announced</p></div>';
                } else {
                    let html = '<div class="sponsors-grid">';
                    sponsorsSnap.forEach(doc => {
                        const s = doc.data();
                        html += `<div class="sponsor-card">
                            <div class="sponsor-logo">${s.logoUrl ? `<img src="${s.logoUrl}" alt="${s.name}">` : '<i class="fas fa-hand-holding-usd"></i>'}</div>
                            <h3>${s.name}</h3>
                            <span class="sponsor-tier">${s.tier || 'Partner'}</span>
                            ${s.description ? `<p>${s.description}</p>` : ''}
                        </div>`;
                    });
                    html += '</div>';
                    container.innerHTML = html;
                }
            } catch (error) {
                console.error("Error loading sponsors:", error);
            }
        }

        async function loadTeamMembers() {
            try {
                const membersSnap = await db.collection('teamMembers')
                    .where('active', '==', true).orderBy('order', 'asc').get();
                const container = document.getElementById('team-members-container');
                if (!container) return;
                if (membersSnap.empty) {
                    container.innerHTML = '<div class="empty-placeholder"><p>Our amazing team will be announced soon...</p></div>';
                } else {
                    let html = '';
                    membersSnap.forEach(doc => {
                        const m = doc.data();
                        html += `<div class="team-card">
                            <div class="team-avatar">${m.photoURL ? `<img src="${m.photoURL}" alt="${m.name}">` : '<i class="fas fa-user"></i>'}</div>
                            <h3>${m.name}</h3>
                            <span class="team-role">${m.designation}</span>
                            ${m.bio ? `<p class="team-bio">${m.bio}</p>` : ''}
                            <div class="team-socials">
                                ${m.linkedin ? `<a href="${m.linkedin}" target="_blank"><i class="fab fa-linkedin"></i></a>` : ''}
                                ${m.twitter ? `<a href="${m.twitter}" target="_blank"><i class="fab fa-twitter"></i></a>` : ''}
                                ${m.github ? `<a href="${m.github}" target="_blank"><i class="fab fa-github"></i></a>` : ''}
                            </div>
                        </div>`;
                    });
                    container.innerHTML = html;
                }
            } catch (error) {
                console.error("Error loading team members:", error);
            }
        }

        // ============================================
        // SETTINGS
        // ============================================
        async function loadSettings() {
            try {
                const settingsDoc = await db.collection(COLLECTIONS.SETTINGS).doc('config').get();
                if (settingsDoc.exists) {
                    const data = settingsDoc.data();
                    if (data.eventDate) appSettings.eventDate = data.eventDate;
                    if (data.deadlineDate) appSettings.deadlineDate = data.deadlineDate;
                    if (data.maxTeams) appSettings.maxTeams = data.maxTeams;
                    if (data.registrationOpen !== undefined) appSettings.registrationOpen = data.registrationOpen;
                    if (data.themes) appSettings.themes = data.themes;
                    updateRegistrationDeadline();
                }
            } catch (error) {
                console.error("Error loading settings:", error);
            }
        }

        function updateRegistrationDeadline() {
            const deadlineElements = document.querySelectorAll('.deadline-date');
            deadlineElements.forEach(el => {
                const date = new Date(appSettings.deadlineDate + 'T23:59:59');
                el.textContent = date.toLocaleDateString('en-US', { day: 'numeric', month: 'short', year: 'numeric' });
            });
        }

        // ============================================
        // UI FUNCTIONS
        // ============================================
        function updateAuthUI() {
            const role = localStorage.getItem('userRole');
            const guest = document.getElementById('guest-nav');
            const authNav = document.getElementById('auth-nav');
            const regBtn = document.getElementById('nav-reg-btn');
            const heroBtn = document.getElementById('hero-action-btn');
            const dashboardNav = document.getElementById('dashboard-nav-item');
            if (currentUser) {
                guest.classList.add('hidden');
                authNav.classList.remove('hidden');
                authNav.classList.add('flex');
                if (role === 'lead') {
                    regBtn.classList.remove('hidden');
                    dashboardNav.classList.remove('hidden');
                    if (heroBtn) { heroBtn.innerText = "Register Your Team Now"; heroBtn.onclick = () => switchView('register'); }
                } else if (role === 'member') {
                    regBtn.classList.add('hidden');
                    dashboardNav.classList.remove('hidden');
                    if (heroBtn) { heroBtn.innerText = "Go to Dashboard"; heroBtn.onclick = () => switchView('dashboard'); }
                }
            } else {
                guest.classList.remove('hidden');
                authNav.classList.add('hidden');
                authNav.classList.remove('flex');
                dashboardNav.classList.add('hidden');
                if (heroBtn) { heroBtn.innerText = "Start Registration"; heroBtn.onclick = () => switchView('lead-login'); }
            }
        }

        function logout() {
            auth.signOut();
            localStorage.removeItem('userRole');
            localStorage.removeItem('userIdentifier');
            currentUser = null;
            updateAuthUI();
            notify("Logged out successfully", "info");
            switchView('landing');
        }

        function startCountdown() {
            let targetDateString = appSettings.eventDate;
            if (targetDateString && targetDateString.length === 10) {
                targetDateString = `${targetDateString} 09:00:00`;
            }
            const targetDate = new Date(targetDateString).getTime();
            function update() {
                const now = new Date().getTime();
                const distance = targetDate - now;
                if (distance < 0) {
                    document.getElementById('days').textContent = '00';
                    document.getElementById('hours').textContent = '00';
                    document.getElementById('minutes').textContent = '00';
                    document.getElementById('seconds').textContent = '00';
                    return;
                }
                document.getElementById('days').textContent = String(Math.floor(distance / (1000 * 60 * 60 * 24))).padStart(2, '0');
                document.getElementById('hours').textContent = String(Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))).padStart(2, '0');
                document.getElementById('minutes').textContent = String(Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60))).padStart(2, '0');
                document.getElementById('seconds').textContent = String(Math.floor((distance % (1000 * 60)) / 1000)).padStart(2, '0');
            }
            update();
            setInterval(update, 1000);
        }

        function toggleNotifications() {
            document.getElementById('notification-dropdown').classList.toggle('active');
            document.getElementById('notif-badge').classList.add('hidden');
        }

        function clearNotifs() {
            document.getElementById('notif-list').innerHTML = '<div class="notif-item">No notifications</div>';
            notify("Cleared", "info");
        }

        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const icon = document.getElementById('theme-icon');
            if (document.body.classList.contains('light-mode')) {
                icon.classList.replace('fa-sun', 'fa-moon');
                localStorage.setItem('theme', 'light');
            } else {
                icon.classList.replace('fa-moon', 'fa-sun');
                localStorage.setItem('theme', 'dark');
            }
        }

        function toggleMobileMenu() {
            const navLinks = document.querySelector('.nav-links');
            const mobileBtn = document.querySelector('.mobile-menu-btn i');
            navLinks.classList.toggle('mobile-open');
            if (navLinks.classList.contains('mobile-open')) {
                mobileBtn.classList.replace('fa-bars', 'fa-xmark');
            } else {
                mobileBtn.classList.replace('fa-xmark', 'fa-bars');
            }
        }

        function closeAllNotificationsModal() {
            document.getElementById('all-notifications-modal').style.display = 'none';
        }

        // Scroll handler for navbar
        window.onscroll = () => {
            const nav = document.getElementById('navbar');
            if (window.scrollY > 50) nav.classList.add('scrolled');
            else nav.classList.remove('scrolled');
        };

        // Close dropdown on outside click
        window.addEventListener('click', (e) => {
            const parent = document.getElementById('notif-parent');
            const dd = document.getElementById('notification-dropdown');
            if (parent && !parent.contains(e.target)) dd.classList.remove('active');
        });

        // Close mobile menu on link click
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('nav-btn') || e.target.closest('.nav-btn')) {
                const navLinks = document.querySelector('.nav-links');
                if (navLinks.classList.contains('mobile-open')) {
                    toggleMobileMenu();
                }
            }
        });

        // Right click disable
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            return false;
        });

        // ============================================
        // PARTICLES BACKGROUND ANIMATION
        // ============================================
        function initParticles() {
            const canvas = document.getElementById('particle-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            let particles = [];
            const particleCount = 60;

            function resize() {
                canvas.width = canvas.parentElement.offsetWidth;
                canvas.height = canvas.parentElement.offsetHeight;
            }
            resize();
            window.addEventListener('resize', resize);

            class Particle {
                constructor() {
                    this.reset();
                }
                reset() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.vx = (Math.random() - 0.5) * 0.5;
                    this.vy = (Math.random() - 0.5) * 0.5;
                    this.radius = Math.random() * 2 + 0.5;
                    this.opacity = Math.random() * 0.5 + 0.1;
                }
                update() {
                    this.x += this.vx;
                    this.y += this.vy;
                    if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
                    if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
                }
                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(249, 115, 22, ${this.opacity})`;
                    ctx.fill();
                }
            }

            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }

            function connectParticles() {
                for (let i = 0; i < particles.length; i++) {
                    for (let j = i + 1; j < particles.length; j++) {
                        const dx = particles[i].x - particles[j].x;
                        const dy = particles[i].y - particles[j].y;
                        const dist = Math.sqrt(dx * dx + dy * dy);
                        if (dist < 150) {
                            ctx.beginPath();
                            ctx.strokeStyle = `rgba(249, 115, 22, ${0.08 * (1 - dist / 150)})`;
                            ctx.lineWidth = 0.5;
                            ctx.moveTo(particles[i].x, particles[i].y);
                            ctx.lineTo(particles[j].x, particles[j].y);
                            ctx.stroke();
                        }
                    }
                }
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => { p.update(); p.draw(); });
                connectParticles();
                requestAnimationFrame(animate);
            }
            animate();
        }

        // ============================================
        // VENUE MAP INITIALIZATION
        // ============================================
        function initVenueMap() {
            const mapContainer = document.getElementById('venue-map');
            if (!mapContainer) return;

            // VTU-VRIF-TCOE Building coordinates (Bengaluru)
            const venueCoordinates = [12.9716, 77.5946]; // Bangalore coordinates
            const venueAddress = "Ground Floor, VTU-VRIF-TCOE Building<br>1st Main Road, RHCS Layout<br>Annapoorneshwari Nagar, Naagarabhaavi<br>Bengaluru, Karnataka 560091";

            // Initialize map
            const map = L.map('venue-map').setView(venueCoordinates, 15);

            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors',
                maxZoom: 19,
                minZoom: 10
            }).addTo(map);

            // Add marker with popup
            const marker = L.marker(venueCoordinates).addTo(map);
            marker.bindPopup(`
                <div style="font-family: var(--font-family); max-width: 250px;">
                    <h4 style="margin: 0 0 8px 0; color: #f97316;">AirFoxer Hackathon Venue</h4>
                    <p style="margin: 0 0 12px 0; font-size: 0.875rem; line-height: 1.5;">
                        ${venueAddress}
                    </p>
                    <a href="https://www.google.com/maps/search/?api=1&query=12.9716,77.5946" target="_blank" style="color: #f97316; text-decoration: none; font-weight: 500;">
                        <i class="fa-solid fa-directions"></i> Directions
                    </a>
                </div>
            `, { maxWidth: 300 });
            
            marker.openPopup();

            // Add circle to show venue area
            L.circle(venueCoordinates, {
                color: '#f97316',
                fillColor: '#f97316',
                fillOpacity: 0.1,
                radius: 500,
                weight: 2
            }).addTo(map);
        }

        // ============================================
        // AUTH: EMAIL/PASSWORD LOGIN
        // ============================================
        const leadEmailForm = document.getElementById('lead-email-form');
        if (leadEmailForm) {
            leadEmailForm.onsubmit = async (e) => {
                e.preventDefault();
                const email = document.getElementById('lead-email').value.trim();
                const password = document.getElementById('lead-pass').value;
                if (!email || !password) {
                    notify("Please enter both email and password", "error");
                    return;
                }
                try {
                    showLoading(true);
                    await auth.signInWithEmailAndPassword(email, password);
                    await logActivity('LEAD_LOGIN', `Lead logged in: ${email}`);
                } catch (error) {
                    let message = "Login failed";
                    if (error.code === 'auth/user-not-found') message = "No account found with this email";
                    else if (error.code === 'auth/wrong-password') message = "Incorrect password";
                    else if (error.code === 'auth/invalid-email') message = "Invalid email format";
                    else if (error.code === 'auth/too-many-requests') message = "Too many attempts. Try again later.";
                    notify(message, "error");
                } finally {
                    showLoading(false);
                }
            };
        }

        // ============================================
        // AUTH: GOOGLE SIGN IN
        // ============================================
        const googleBtn = document.getElementById('firebase-google-btn');
        if (googleBtn) {
            googleBtn.onclick = async function () {
                try {
                    const provider = new firebase.auth.GoogleAuthProvider();
                    provider.addScope('email');
                    provider.addScope('profile');
                    const result = await auth.signInWithPopup(provider);
                    notify(`Welcome ${result.user.displayName || result.user.email}!`, "success");
                    handleAuthSuccess('lead', result.user.email);
                } catch (error) {
                    let message = "Google sign-in failed";
                    if (error.code === 'auth/popup-blocked') message = "Popup blocked. Please allow popups for this site.";
                    else if (error.code === 'auth/network-request-failed') message = "Network error. Check your connection.";
                    notify(message, "error");
                }
            };
        }

        // ============================================
        // INITIALIZE ON LOAD
        // ============================================
        document.addEventListener('DOMContentLoaded', async () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('theme-icon').classList.replace('fa-sun', 'fa-moon');
            }
            updateAuthUI();
            await loadSettings();
            loadTeamMembers();
            loadHostingPartners();
            loadSponsors();
            initVenueMap();
            startCountdown();
            loadUserNotifications();
            initParticles();
            window.addEventListener('beforeunload', () => {
                if (window.notificationUnsubscribe) window.notificationUnsubscribe();
            });
        });
    </script>
</body>
</html>